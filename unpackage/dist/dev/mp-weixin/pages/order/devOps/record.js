"use strict";const e=require("../../../common/vendor.js");require("../../../utils/request.js");const p=require("../../../api/order.js"),y=require("../../../uni_modules/wot-design-uni/components/wd-message-box/index.js");require("../../../uni_modules/wot-design-uni/locale/index.js");if(!Array){const i=e.resolveComponent("wd-message-box"),m=e.resolveComponent("BaseLoading"),r=e.resolveComponent("wd-search"),a=e.resolveComponent("wd-sticky"),t=e.resolveComponent("wd-text"),o=e.resolveComponent("wd-button"),s=e.resolveComponent("wd-card"),u=e.resolveComponent("wd-loadmore"),c=e.resolveComponent("wd-fab");(i+m+r+a+t+o+s+u+c)()}const h=()=>"../../../uni_modules/wot-design-uni/components/wd-message-box/wd-message-box.js",x=()=>"../../../components/BaseLoading.js",N=()=>"../../../uni_modules/wot-design-uni/components/wd-search/wd-search.js",j=()=>"../../../uni_modules/wot-design-uni/components/wd-sticky/wd-sticky.js",C=()=>"../../../uni_modules/wot-design-uni/components/wd-text/wd-text.js",k=()=>"../../../uni_modules/wot-design-uni/components/wd-button/wd-button.js",R=()=>"../../../uni_modules/wot-design-uni/components/wd-card/wd-card.js",I=()=>"../../../uni_modules/wot-design-uni/components/wd-loadmore/wd-loadmore.js",q=()=>"../../../uni_modules/wot-design-uni/components/wd-fab/wd-fab.js";Math||(h+x+N+j+C+k+R+I+q)();const B={__name:"record",setup(i){const m=y.useMessage(),r=e.ref(!1),a=e.ref([]),t=e.ref(0),o=e.reactive({pageNum:1,pageSize:10,order:"asc",plateNumber:void 0,offset:0,limit:10}),s=e.ref("loading");e.onReachBottom(()=>{a.value.length===t.value?s.value="finished":a.value.length?a.value.length<t.value&&u():s.value="error"}),e.onShow(()=>{s.value="loading",o.plateNumber=void 0,o.pageNum=1,o.order="asc",a.value=[],t.value=0,c()});function u(){o.pageNum++,c(),s.value="loading"}const c=async()=>{r.value=!0;const d=await p.getRecordList(o);a.value=[...a.value,...d.rows],t.value=d.total,r.value=!1,a.value.length===t.value?s.value="finished":a.value.length||(s.value="error")},_=d=>{e.index.navigateTo({url:`/pages/order/devOps/recordForm${d?`?id=${d}`:""}`})},g=d=>{m.confirm({title:"提示信息",msg:"是否确认删除此项记录信息？"}).then(async()=>{(await p.deleteRecord(d.maintenanceRecordId)).code==200&&(o.pageNum=1,c(),e.index.showToast({title:"删除成功",icon:"success"}),s.value="loading",o.plateNumber=void 0,o.pageNum=1,o.order="asc",a.value=[],t.value=0,c())}).catch(()=>{e.index.__f__("log","at pages/order/devOps/record.vue:91","点击了取消按钮")})},v=()=>{o.plateNumber&&(s.value="loading",o.pageNum=1,o.order="asc",a.value=[],t.value=0,c())},w=()=>{o.plateNumber&&(s.value="loading",o.plateNumber=void 0,o.pageNum=1,o.order="asc",a.value=[],t.value=0,c())};return(d,f)=>e.e({a:r.value&&!a.value.length},r.value&&!a.value.length?{b:e.p({loading:r.value})}:{c:e.o(v),d:e.o(w),e:e.o(e.m(n=>o.plateNumber=n,{trim:!0},!0)),f:e.p({modelValue:o.plateNumber}),g:e.f(a.value,(n,L,l)=>e.e({a:n.plateNumber},n.plateNumber?{b:e.t(n.plateNumber)}:{},{c:e.t(n.maintenanceRecordTypeName),d:e.t(n.maintenanceDate),e:e.t(n.maintenanceValidDate||"无"),f:"5f127210-5-"+l+","+("5f127210-4-"+l),g:e.p({text:n.maintenanceContent,lines:2,color:"#333"}),h:"5f127210-6-"+l+","+("5f127210-4-"+l),i:e.o(b=>g(n),n.maintenanceRecordId),j:"5f127210-4-"+l,k:n.maintenanceRecordId,l:e.o(b=>_(n.maintenanceRecordId),n.maintenanceRecordId)})),h:e.p({size:"small",type:"error"}),i:e.o(u),j:e.p({state:s.value})},{k:e.o(_),l:e.p({activeIcon:"add",expandable:!1})})}},D=e._export_sfc(B,[["__scopeId","data-v-5f127210"]]);wx.createPage(D);
//# sourceMappingURL=../../../../.sourcemap/mp-weixin/pages/order/devOps/record.js.map
