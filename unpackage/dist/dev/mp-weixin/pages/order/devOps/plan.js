"use strict";const e=require("../../../common/vendor.js");require("../../../utils/request.js");const _=require("../../../api/order.js"),y=require("../../../uni_modules/wot-design-uni/components/wd-message-box/index.js");require("../../../uni_modules/wot-design-uni/locale/index.js");if(!Array){const m=e.resolveComponent("wd-message-box"),d=e.resolveComponent("BaseLoading"),l=e.resolveComponent("wd-search"),t=e.resolveComponent("wd-sticky"),o=e.resolveComponent("wd-button"),a=e.resolveComponent("wd-card"),c=e.resolveComponent("wd-loadmore"),r=e.resolveComponent("wd-status-tip");(m+d+l+t+o+a+c+r)()}const b=()=>"../../../uni_modules/wot-design-uni/components/wd-message-box/wd-message-box.js",x=()=>"../../../components/BaseLoading.js",N=()=>"../../../uni_modules/wot-design-uni/components/wd-search/wd-search.js",I=()=>"../../../uni_modules/wot-design-uni/components/wd-sticky/wd-sticky.js",j=()=>"../../../uni_modules/wot-design-uni/components/wd-button/wd-button.js",k=()=>"../../../uni_modules/wot-design-uni/components/wd-card/wd-card.js",C=()=>"../../../uni_modules/wot-design-uni/components/wd-loadmore/wd-loadmore.js",M=()=>"../../../uni_modules/wot-design-uni/components/wd-status-tip/wd-status-tip.js";Math||(b+x+N+I+j+k+C+M)();const P={__name:"plan",setup(m){const d=y.useMessage(),l=e.ref(!1),t=e.ref([]),o=e.ref(0),a=e.reactive({pageNum:1,pageSize:10,order:"asc",plateNumber:""}),c=e.ref("loading");e.onReachBottom(()=>{t.value.length?t.value.length===o.value?c.value="finished":t.value.length<o.value&&r():c.value="error"}),e.onShow(()=>{c.value="loading",a.plateNumber="",a.pageNum=1,a.order="asc",t.value=[],o.value=0,u()});function r(){a.pageNum++,u(),c.value="loading"}const u=async()=>{l.value=!0;const s=await _.getPlanList(a);t.value=[...t.value,...s.rows],o.value=s.total,l.value=!1,t.value.length===o.value?c.value="finished":t.value.length||(c.value="error")},p=s=>{e.index.navigateTo({url:`/pages/order/devOps/planForm${s?`?id=${s}`:""}`})},v=s=>{if(!(s.lastMaintenance||s.nextMaintenance||s.lastInspection||s.nextInspection||s.lastInsurance||s.nextInsurance)){e.index.showToast({title:"请先完善保养信息",icon:"none"});return}d.confirm({title:"提示信息",msg:"是否确认重置车辆保养信息？"}).then(async()=>{(await _.putPlan(s.maintenancePlanId)).code==200&&(a.pageNum=1,u(),e.index.showToast({title:"重置成功",icon:"success"}),c.value="loading",a.plateNumber="",a.pageNum=1,a.order="asc",t.value=[],o.value=0,u())}).catch(()=>{e.index.__f__("log","at pages/order/devOps/plan.vue:99","点击了取消按钮")})},g=()=>{a.plateNumber&&(c.value="loading",a.pageNum=1,a.order="asc",t.value=[],o.value=0,u())},w=()=>{a.plateNumber&&(c.value="loading",a.plateNumber="",a.pageNum=1,a.order="asc",t.value=[],o.value=0,u())};return(s,h)=>e.e({a:l.value&&!t.value.length},l.value&&!t.value.length?{b:e.p({loading:l.value})}:{c:e.o(g),d:e.o(w),e:e.o(e.m(n=>a.plateNumber=n,{trim:!0},!0)),f:e.p({modelValue:a.plateNumber}),g:e.f(t.value,(n,B,i)=>e.e({a:n.plateNumber},n.plateNumber?{b:e.t(n.plateNumber)}:{},{c:e.t(n.deptName),d:e.t(n.lastMaintenance),e:e.t(n.nextMaintenance),f:e.t(n.lastInspection),g:e.t(n.nextInspection),h:e.t(n.lastInsurance),i:e.t(n.nextInsurance),j:"27ed622e-5-"+i+","+("27ed622e-4-"+i),k:e.o(f=>v(n),n.vehicleId),l:"27ed622e-4-"+i,m:n.vehicleId,n:e.o(f=>p(n.vehicleId),n.vehicleId)})),h:e.p({size:"small",type:"warning"}),i:e.o(r),j:e.p({state:c.value})},{k:!l.value&&o.value==0},!l.value&&o.value==0?{l:e.p({image:"/static/content.png",tip:"暂无列表"})}:{})}},q=e._export_sfc(P,[["__scopeId","data-v-27ed622e"]]);wx.createPage(q);
//# sourceMappingURL=../../../../.sourcemap/mp-weixin/pages/order/devOps/plan.js.map
