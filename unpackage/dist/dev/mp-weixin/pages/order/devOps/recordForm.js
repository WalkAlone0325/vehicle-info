"use strict";const e=require("../../../common/vendor.js"),y=require("../../../api/home.js"),m=require("../../../api/order.js"),F=require("../../../api/common.js");if(!Array){const p=e.resolveComponent("wd-select-picker"),r=e.resolveComponent("wd-picker"),c=e.resolveComponent("wd-datetime-picker"),u=e.resolveComponent("wd-input"),l=e.resolveComponent("wd-textarea"),a=e.resolveComponent("wd-cell-group"),s=e.resolveComponent("wd-button"),d=e.resolveComponent("wd-form"),i=e.resolveComponent("BaseForm");(p+r+c+u+l+a+s+d+i)()}const b=()=>"../../../uni_modules/wot-design-uni/components/wd-select-picker/wd-select-picker.js",g=()=>"../../../uni_modules/wot-design-uni/components/wd-picker/wd-picker.js",h=()=>"../../../uni_modules/wot-design-uni/components/wd-datetime-picker/wd-datetime-picker.js",f=()=>"../../../uni_modules/wot-design-uni/components/wd-input/wd-input.js",C=()=>"../../../uni_modules/wot-design-uni/components/wd-textarea/wd-textarea.js",k=()=>"../../../uni_modules/wot-design-uni/components/wd-cell-group/wd-cell-group.js",B=()=>"../../../uni_modules/wot-design-uni/components/wd-button/wd-button.js",D=()=>"../../../uni_modules/wot-design-uni/components/wd-form/wd-form.js",x=()=>"../../../components/BaseForm.js";Math||(b+g+h+f+C+k+B+D+x)();const V={__name:"recordForm",setup(p){const r=e.ref([]),c=e.ref({}),u=e.ref(!1),l=e.ref(null),a=e.ref({vehicleId:"",plateNumber:"",maintenanceRecordTypeCode:"",maintenanceDate:"",maintenanceValidDate:"",maintenanceContent:"",remark:""}),s=e.ref({vehicleId:[{required:!0,message:"请选择车辆车牌"}],maintenanceRecordTypeCode:[{required:!0,message:"请选择保养类型"}],maintenanceDate:[{required:!0,message:"请选择保养日期"}],maintenanceValidDate:[{required:!0,message:"请输入有效日期（月）"}],maintenanceContent:[{required:!0,message:"请输入保养内容"}]}),d=async()=>{const o=await y.getCarListApi({order:"asc"});r.value=o.rows},i=({value:o})=>{const n=r.value.find(t=>t.vehicleId===o);a.value.plateNumber=n.plateNumber},_=async o=>{const n=await m.getRecordDetail(o);a.value=n.data},w=async o=>{const n=await F.getDictApi(o);c.value[o]=n.data},v=()=>{l.value.validate().then(async({valid:o,errors:n})=>{if(o){u.value=!0;let t;a.value.maintenanceRecordId?t=await m.putRecord(a.value):t=await m.postRecord(a.value),t.code==200&&e.index.showToast({title:"提交成功",icon:"success",duration:1e3,success:()=>{setTimeout(()=>{u.value=!1,e.index.navigateBack({delta:1})},1e3)}}),u.value=!1}}).catch(o=>{e.index.__f__("log","at pages/order/devOps/recordForm.vue:88",o,"error")})};return e.onLoad(o=>{o.id&&_(o.id),d(),w("vehicle_maintenance_record_type")}),(o,n)=>({a:e.o(i),b:e.o(t=>a.value.vehicleId=t),c:e.p({clearable:!0,type:"radio","value-key":"vehicleId","label-key":"plateNumber","label-width":"100px",prop:"vehicleId",label:"车辆车牌",placeholder:"请选择车辆车牌",columns:r.value,filterable:!0,"show-confirm":!1,modelValue:a.value.vehicleId}),d:e.o(t=>a.value.maintenanceRecordTypeCode=t),e:e.p({clearable:!0,label:"保养类型",placeholder:"请选择保养类型","value-key":"dictValue","label-key":"dictLabel","label-width":"100px",prop:"maintenanceRecordTypeCode",columns:c.value.vehicle_maintenance_record_type,modelValue:a.value.maintenanceRecordTypeCode}),f:e.o(t=>a.value.maintenanceDate=t),g:e.p({clearable:!0,label:"保养日期",type:"date","label-width":"100px",placeholder:"请选择日期",prop:"maintenanceDate",modelValue:a.value.maintenanceDate}),h:e.o(t=>a.value.maintenanceValidDate=t),i:e.p({clearable:!0,type:"number","label-width":"120px",label:"有效日期（月）",placeholder:"请输入有效日期（月）",prop:"maintenanceValidDate",modelValue:a.value.maintenanceValidDate}),j:e.o(t=>a.value.maintenanceContent=t),k:e.p({label:"保养内容","label-width":"100px",type:"textarea",maxlength:300,"show-word-limit":!0,placeholder:"请输入保养内容",clearable:!0,prop:"maintenanceContent",modelValue:a.value.maintenanceContent}),l:e.o(t=>a.value.remark=t),m:e.p({label:"备注","label-width":"100px",prop:"remark",clearable:!0,placeholder:"请输入备注",modelValue:a.value.remark}),n:e.p({border:!0}),o:e.o(v),p:e.p({type:"primary",loading:u.value,block:!0}),q:e.sr(l,"dd803224-1,dd803224-0",{k:"form"}),r:e.p({model:a.value,rules:s.value,errorType:"toast"})})}},j=e._export_sfc(V,[["__scopeId","data-v-dd803224"]]);wx.createPage(j);
//# sourceMappingURL=../../../../.sourcemap/mp-weixin/pages/order/devOps/recordForm.js.map
