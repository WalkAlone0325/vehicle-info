"use strict";const e=require("../../common/vendor.js"),f=require("../../common/assets.js"),p=require("../../utils/index.js"),b={__name:"map",setup(C){e.ref(null),e.ref(null);const h=e.ref(20),o=e.ref([]),c=e.ref([]);e.ref({});const l=e.ref({latitude:"",longitude:""}),m=e.ref({});e.ref(0);const k=e.ref(1),s=e.ref({}),g=async(a,t)=>{switch(t){case"addMark":e.index.showModal({title:"æç¤º",content:"æ˜¯å¦ç¡®è®¤åœ¨æ­¤å¤„æ ‡ç‚¹ï¼Ÿ",success:async n=>{if(n.confirm){const{latitude:i,longitude:d}=a;x(i,d,k.value++)}},fail:n=>{e.index.__f__("log","at pages/index/map.vue:38",n,"err")}});break}},r=e.ref({}),x=(a,t,n)=>{const i=r.value.latitude?e.toRaw(r.value):{latitude:l.value.latitude,longitude:l.value.longitude};r.value={latitude:a,longitude:t},c.value.push({id:n,points:[i,{latitude:a,longitude:t}],width:5,clickable:!0,arrowLine:!0,color:p.randomRgbColor()}),o.value.push({id:n,latitude:a,longitude:t,iconPath:"../../static/current.png",width:30,height:30})},u=e.ref(-1),v=async a=>{e.index.__f__("log","at pages/index/map.vue:92","ðŸš€:>> ",c.value);const t=await _();if(a==="local")e.index.__f__("log","at pages/index/map.vue:96",t,"current"),l.value.latitude=t.latitude,l.value.longitude=t.longitude;else if(a==="mark"){const n=[{latitude:37.78155385785984,longitude:112.56031978420128},{latitude:37.78304276611586,longitude:112.5613987268813},{latitude:37.78167095013985,longitude:112.55824860145844}];u.value=u.value+1,e.index.__f__("log","at pages/index/map.vue:108","ðŸš€:>> ",n[u.value],u.value),g(n[u.value],"addMark")}},_=()=>new Promise(a=>{e.index.getLocation({type:"gcj02",isHighAccuracy:!0,success:t=>{m.value=t,o.value.length||(l.value.latitude=t.latitude,l.value.longitude=t.longitude,o.value=[{id:1,latitude:t.latitude,longitude:t.longitude,iconPath:"../../static/current.png",width:30,height:30}]),a(t)},fail:t=>e.index.__f__("log","at pages/index/map.vue:139",t,"err")})}),w=a=>{const{latitude:t,longitude:n,polylineId:i}=a.detail;s.value=c.value.find(d=>d.id===i),y(t,n,s.value)},P=e.ref(1e3),y=(a,t,n)=>{const i=n.points;o.value.push({id:P.value++,latitude:a,longitude:t,iconPath:"",width:0,height:0,title:p.getDistance(i[0].latitude,i[0].longitude,i[1].latitude,i[1].longitude)})},M=a=>{};return e.onShow(async()=>{await _()}),e.onUnload(()=>{e.index.stopLocationUpdate({})}),(a,t)=>({a:f._imports_0$1,b:e.o(n=>v("mark")),c:f._imports_1$1,d:e.o(n=>v("local")),e:h.value,f:l.value.longitude,g:l.value.latitude,h:o.value,i:c.value,j:e.o(g),k:e.o(M),l:e.o(w)})}},L=e._export_sfc(b,[["__scopeId","data-v-de8b6376"]]);wx.createPage(L);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/index/map.js.map
