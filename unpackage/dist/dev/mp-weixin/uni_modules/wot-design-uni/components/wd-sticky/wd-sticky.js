"use strict";const o=require("../../../../common/vendor.js"),s=require("../common/util.js"),S=require("./types.js"),k=require("../composables/useParent.js"),C=require("../wd-sticky-box/types.js");Math||T();const T=()=>"../wd-resize/wd-resize.js",U={name:"wd-sticky",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"}},z=o.defineComponent({...U,props:S.stickyProps,setup(p,{expose:h}){const r=p,c=o.ref(`wd-sticky${s.uuid()}`),a=o.ref([]),e=o.reactive({position:"absolute",boxLeaved:!1,top:0,height:0,width:0,state:""}),{parent:i}=k.useParent(C.STICKY_BOX_KEY),{proxy:l}=o.getCurrentInstance(),f=o.computed(()=>{const t={"z-index":r.zIndex,height:s.addUnit(e.height),width:s.addUnit(e.width)};return e.boxLeaved||(t.position="relative"),`${s.objToStyle(t)}${r.customStyle}`}),y=o.computed(()=>{const t={"z-index":r.zIndex,height:s.addUnit(e.height),width:s.addUnit(e.width)};return e.boxLeaved||(t.position="relative"),`${s.objToStyle(t)}`}),v=o.computed(()=>{const t={position:e.position,top:s.addUnit(e.top)};return s.objToStyle(t)}),u=o.computed(()=>0+r.offsetTop);function _(){for(;a.value.length!==0;)a.value.pop().disconnect()}function b(){const t=o.index.createIntersectionObserver(l,{thresholds:[0,.5]});return a.value.push(t),t}async function m(t){e.width=t.width,e.height=t.height,await s.pause(),w(),!(!i||!i.observerForChild)&&i.observerForChild(l)}function w(){if(e.height===0&&e.width===0)return;const t=u.value+e.height;_(),b().relativeToViewport({top:-t}).observe(`#${c.value}`,n=>{d(n)}),s.getRect(`#${c.value}`,!1,l).then(n=>{Number(n.bottom)<=t&&d({boundingClientRect:n})})}function d({boundingClientRect:t}){if(i&&i.boxStyle&&e.height>=i.boxStyle.height){e.position="absolute",e.top=0;return}t.top<=u.value?(e.state="sticky",e.boxLeaved=!1,e.position="fixed",e.top=u.value):(e.state="normal",e.boxLeaved=!1,e.position="absolute",e.top=0)}function g(t,n,x){e.boxLeaved=t,e.position=n,e.top=x}return h({setPosition:g,stickyState:e,offsetTop:r.offsetTop}),(t,n)=>({a:o.o(m),b:o.p({"custom-style":"display: inline-block;"}),c:o.s(v.value),d:o.n(`wd-sticky ${t.customClass}`),e:o.s(y.value),f:c.value,g:o.s(`${f.value};display: inline-block;`)})}}),I=o._export_sfc(z,[["__scopeId","data-v-2722b5fd"]]);wx.createComponent(I);
//# sourceMappingURL=../../../../../.sourcemap/mp-weixin/uni_modules/wot-design-uni/components/wd-sticky/wd-sticky.js.map
