"use strict";const e=require("../../../../common/vendor.js"),b=require("../common/util.js"),z=require("../composables/useQueue.js"),T=require("../common/clickoutside.js"),F=require("./types.js"),O=require("../composables/useRaf.js");Math||(M+B+R)();const B=()=>"../wd-button/wd-button.js",M=()=>"../wd-icon/wd-icon.js",R=()=>"../wd-transition/wd-transition.js",Y={name:"wd-fab",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}},P=e.defineComponent({...Y,props:F.fabProps,emits:["update:active","click"],setup(L,{expose:C,emit:q}){const n=L,g=q,k=e.ref(!1),c=e.ref(!1),u=e.inject(z.queueKey,null),{proxy:m}=e.getCurrentInstance();e.watch(()=>n.active,t=>{c.value=t},{immediate:!0,deep:!0}),e.watch(()=>c.value,t=>{t&&(u&&u.closeOther?u.closeOther(m):T.closeOther(m))});const p=e.ref(n.direction);e.watch(()=>n.direction,t=>p.value=t),e.watch(()=>n.position,()=>I());const i=e.ref(0),a=e.ref(0),h=e.reactive({width:0,height:0}),w=e.reactive({width:56,height:56}),f=e.reactive({minTop:0,minLeft:0,maxTop:0,maxLeft:0});async function $(){const t=e.index.getSystemInfoSync();try{const s=await b.getRect("#trigger",!1,m);w.width=s.width||56,w.height=s.height||56}catch(s){e.index.__f__("log","at uni_modules/wot-design-uni/components/wd-fab/wd-fab.vue:112",s)}const{top:o=16,left:l=16,right:r=16,bottom:d=16}=n.gap;h.width=t.windowWidth,h.height=b.isH5?t.windowTop+t.windowHeight:t.windowHeight,f.minTop=b.isH5?t.windowTop+o:o,f.minLeft=l,f.maxLeft=h.width-w.width-r,f.maxTop=h.height-w.height-d}function I(){const t=n.position,{minLeft:o,minTop:l,maxLeft:r,maxTop:d}=f,s=(d+l)/2,v=(r+o)/2;switch(t){case"left-top":i.value=l,a.value=o;break;case"right-top":i.value=l,a.value=r;break;case"left-bottom":i.value=d,a.value=o;break;case"right-bottom":i.value=d,a.value=r;break;case"left-center":i.value=s,a.value=o;break;case"right-center":i.value=s,a.value=r;break;case"top-center":i.value=l,a.value=v;break;case"bottom-center":i.value=d,a.value=v;break}}const y=e.reactive({x:0,y:0}),x=e.ref(!1);function D(t){if(n.draggable===!1)return;const o=t.touches[0];y.x=o.clientX-a.value,y.y=o.clientY-i.value,x.value=!1}function Q(t){if(n.draggable===!1)return;const o=t.touches[0],{minLeft:l,minTop:r,maxLeft:d,maxTop:s}=f;let v=o.clientX-y.x,_=o.clientY-y.y;v<l?v=l:v>d&&(v=d),_<r?_=r:_>s&&(_=s),i.value=_,a.value=v}function S(){if(n.draggable===!1)return;const t=h.width/2,o=a.value+w.width/2;x.value=!0,o<t?(a.value=f.minLeft,p.value="right"):(a.value=f.maxLeft,p.value="left")}const j=e.computed(()=>{const t={top:i.value+"px",left:a.value+"px",transition:x.value?"all ease 0.3s":"none"};return b.isDef(n.zIndex)&&(t["z-index"]=n.zIndex),`${b.objToStyle(t)}${n.customStyle}`});e.onMounted(()=>{u&&u.pushToQueue?u.pushToQueue(m):T.pushToQueue(m);const{start:t}=O.useRaf(async()=>{await $(),I(),k.value=!0});t()}),e.onBeforeUnmount(()=>{u&&u.removeFromQueue?u.removeFromQueue(m):T.removeFromQueue(m)});function U(){if(!n.disabled){if(!n.expandable){g("click");return}c.value=!c.value,g("update:active",c.value)}}function H(){c.value=!0,g("update:active",!0)}function X(){c.value=!1,g("update:active",!1)}return C({open:H,close:X}),(t,o)=>e.e({a:t.$slots.trigger},t.$slots.trigger?{}:{b:e.p({"custom-class":"wd-fab__icon",name:c.value?t.activeIcon:t.inactiveIcon}),c:e.o(U),d:e.p({"custom-class":"wd-fab__trigger",round:!0,type:t.type,disabled:t.disabled})},{e:e.o(()=>{}),f:k.value?"visible":"hidden",g:t.expandable},t.expandable?{h:e.p({"enter-class":`wd-fab__transition-enter--${p.value}`,"enter-active-class":"wd-fab__transition-enter-active","leave-to-class":`wd-fab__transition-leave-to--${p.value}`,"leave-active-class":"wd-fab__transition-leave-active","custom-class":`wd-fab__actions wd-fab__actions--${p.value}`,show:c.value,duration:300})}:{},{i:e.o(Q),j:e.o(D),k:e.o(S),l:e.n(`wd-fab ${t.customClass}`),m:e.s(j.value),n:e.o(()=>{})})}}),A=e._export_sfc(P,[["__scopeId","data-v-c5c35da7"]]);wx.createComponent(A);
//# sourceMappingURL=../../../../../.sourcemap/mp-weixin/uni_modules/wot-design-uni/components/wd-fab/wd-fab.js.map
