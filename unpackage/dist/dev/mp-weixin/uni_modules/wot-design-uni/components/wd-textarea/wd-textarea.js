"use strict";const o=require("../../../../common/vendor.js"),u=require("../common/util.js"),H=require("../composables/useCell.js"),A=require("../wd-form/types.js"),E=require("../composables/useParent.js"),K=require("../composables/useTranslate.js"),O=require("./types.js");Math||R();const R=()=>"../wd-icon/wd-icon.js",z={name:"wd-textarea",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}},G=o.defineComponent({...z,props:O.textareaProps,emits:["update:modelValue","clear","blur","focus","input","keyboardheightchange","confirm","linechange","clickprefixicon","click"],setup(b,{emit:w}){const{translate:y}=K.useTranslate("textarea"),r=b,n=w,$=o.useSlots(),C=o.computed(()=>u.isDef(r.placeholder)?r.placeholder:y("placeholder")),m=o.ref(!1),d=o.ref(!1),i=o.ref(!1),l=o.ref(""),_=H.useCell();o.watch(()=>r.focus,e=>{d.value=e},{immediate:!0,deep:!0}),o.watch(()=>r.modelValue,e=>{l.value=u.isDef(e)?String(e):""},{immediate:!0,deep:!0});const{parent:t}=E.useParent(A.FORM_KEY),f=o.computed(()=>{const{disabled:e,readonly:a,clearable:s,clearTrigger:c}=r;return!!(s&&!a&&!e&&l.value&&(c==="always"||r.clearTrigger==="focus"&&i.value))}),h=o.computed(()=>{const{disabled:e,readonly:a,maxlength:s,showWordLimit:c}=r;return!!(!e&&!a&&u.isDef(s)&&s>-1&&c)}),v=o.computed(()=>t&&r.prop&&t.errorMessages&&t.errorMessages[r.prop]?t.errorMessages[r.prop]:""),q=o.computed(()=>{let e=!1;if(t&&t.props.rules){const a=t.props.rules;for(const s in a)Object.prototype.hasOwnProperty.call(a,s)&&s===r.prop&&Array.isArray(a[s])&&(e=a[s].some(c=>c.required))}return r.required||r.rules.some(a=>a.required)||e}),p=o.computed(()=>Array.from(String(g(r.modelValue))).length),S=o.computed(()=>`wd-textarea   ${r.label||$.label?"is-cell":""} ${r.center?"is-center":""} ${_.border.value?"is-border":""} ${r.size?"is-"+r.size:""} ${r.error?"is-error":""} ${r.disabled?"is-disabled":""} ${r.autoHeight?"is-auto-height":""} ${p.value>0?"is-not-empty":""}  ${r.noBorder?"is-no-border":""} ${r.customClass}`),D=o.computed(()=>`wd-textarea__label ${r.customLabelClass} ${q.value?"is-required":""}`),I=o.computed(()=>`wd-textarea__placeholder  ${r.placeholderClass}`),T=o.computed(()=>`${p.value>0?"wd-textarea__count-current":""} ${p.value>r.maxlength?"is-error":""}`),P=o.computed(()=>r.labelWidth?u.objToStyle({"min-width":r.labelWidth,"max-width":r.labelWidth}):"");o.onBeforeMount(()=>{V()});function V(){l.value=g(l.value),n("update:modelValue",l.value)}function g(e){if(e==null)return"";const{maxlength:a,showWordLimit:s}=r;return s&&a!==-1&&String(e).length>a?e.toString().substring(0,a):`${e}`}async function W(){m.value=!0,i.value=!1,l.value="",r.focusWhenClear&&(d.value=!1),await u.pause(),r.focusWhenClear&&(d.value=!0,i.value=!0),n("update:modelValue",l.value),n("clear")}async function k({detail:e}){if(await u.pause(150),m.value){m.value=!1;return}i.value=!1,n("blur",{value:l.value,cursor:e.cursor?e.cursor:null})}function M({detail:e}){i.value=!0,n("focus",e)}function U({detail:e}){l.value=g(l.value),n("update:modelValue",l.value),n("input",e)}function B({detail:e}){n("keyboardheightchange",e)}function L({detail:e}){n("confirm",e)}function j({detail:e}){n("linechange",e)}function F(){n("clickprefixicon")}return(e,a)=>o.e({a:e.label||e.$slots.label},e.label||e.$slots.label?o.e({b:e.prefixIcon||e.$slots.prefix},e.prefixIcon||e.$slots.prefix?o.e({c:e.prefixIcon&&!e.$slots.prefix},e.prefixIcon&&!e.$slots.prefix?{d:o.o(F),e:o.p({"custom-class":"wd-textarea__icon",name:e.prefixIcon})}:{}):{},{f:e.label&&!e.$slots.label},e.label&&!e.$slots.label?{g:o.t(e.label)}:{},{h:o.n(D.value),i:o.s(P.value)}):{},{j:o.n(`wd-textarea__inner ${e.customTextareaClass}`),k:C.value,l:e.disabled||e.readonly,m:e.maxlength,n:d.value,o:e.autoFocus,p:e.placeholderStyle,q:I.value,r:e.autoHeight,s:e.cursorSpacing,t:e.fixed,v:e.cursor,w:e.showConfirmBar,x:e.selectionStart,y:e.selectionEnd,z:e.adjustPosition,A:e.holdKeyboard,B:e.confirmType,C:e.confirmHold,D:e.disableDefaultPadding,E:e.ignoreCompositionEvent,F:e.inputmode,G:o.o([s=>l.value=s.detail.value,U]),H:o.o(M),I:o.o(k),J:o.o(L),K:o.o(j),L:o.o(B),M:l.value,N:v.value},v.value?{O:o.t(v.value)}:{},{P:r.readonly},r.readonly?{}:{},{Q:f.value},f.value?{R:o.o(W),S:o.p({"custom-class":"wd-textarea__clear",name:"error-fill"})}:{},{T:h.value},h.value?{U:o.t(p.value),V:o.n(T.value),W:o.t(e.maxlength)}:{},{X:o.n(`wd-textarea__value ${f.value?"is-suffix":""} ${e.customTextareaContainerClass} ${h.value?"is-show-limit":""}`),Y:o.n(S.value),Z:o.s(e.customStyle)})}}),Y=o._export_sfc(G,[["__scopeId","data-v-7d71e04e"]]);wx.createComponent(Y);
//# sourceMappingURL=../../../../../.sourcemap/mp-weixin/uni_modules/wot-design-uni/components/wd-textarea/wd-textarea.js.map
