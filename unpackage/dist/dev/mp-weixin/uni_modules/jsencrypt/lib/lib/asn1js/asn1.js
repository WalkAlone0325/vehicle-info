"use strict";const l=require("./int10.js");var S="â€¦",m=/^(\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/,y=/^(\d\d\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/;function c(i,e){return i.length>e&&(i=i.substring(0,e)+S),i}var p=function(){function i(e,t){this.hexDigits="0123456789ABCDEF",e instanceof i?(this.enc=e.enc,this.pos=e.pos):(this.enc=e,this.pos=t)}return i.prototype.get=function(e){if(e===void 0&&(e=this.pos++),e>=this.enc.length)throw new Error("Requesting byte offset ".concat(e," on a stream of length ").concat(this.enc.length));return typeof this.enc=="string"?this.enc.charCodeAt(e):this.enc[e]},i.prototype.hexByte=function(e){return this.hexDigits.charAt(e>>4&15)+this.hexDigits.charAt(e&15)},i.prototype.hexDump=function(e,t,r){for(var n="",s=e;s<t;++s)if(n+=this.hexByte(this.get(s)),r!==!0)switch(s&15){case 7:n+="  ";break;case 15:n+=`
`;break;default:n+=" "}return n},i.prototype.isASCII=function(e,t){for(var r=e;r<t;++r){var n=this.get(r);if(n<32||n>176)return!1}return!0},i.prototype.parseStringISO=function(e,t){for(var r="",n=e;n<t;++n)r+=String.fromCharCode(this.get(n));return r},i.prototype.parseStringUTF=function(e,t){for(var r="",n=e;n<t;){var s=this.get(n++);s<128?r+=String.fromCharCode(s):s>191&&s<224?r+=String.fromCharCode((s&31)<<6|this.get(n++)&63):r+=String.fromCharCode((s&15)<<12|(this.get(n++)&63)<<6|this.get(n++)&63)}return r},i.prototype.parseStringBMP=function(e,t){for(var r="",n,s,a=e;a<t;)n=this.get(a++),s=this.get(a++),r+=String.fromCharCode(n<<8|s);return r},i.prototype.parseTime=function(e,t,r){var n=this.parseStringISO(e,t),s=(r?m:y).exec(n);return s?(r&&(s[1]=+s[1],s[1]+=+s[1]<70?2e3:1900),n=s[1]+"-"+s[2]+"-"+s[3]+" "+s[4],s[5]&&(n+=":"+s[5],s[6]&&(n+=":"+s[6],s[7]&&(n+="."+s[7]))),s[8]&&(n+=" UTC",s[8]!="Z"&&(n+=s[8],s[9]&&(n+=":"+s[9]))),n):"Unrecognized time: "+n},i.prototype.parseInteger=function(e,t){for(var r=this.get(e),n=r>127,s=n?255:0,a,o="";r==s&&++e<t;)r=this.get(e);if(a=t-e,a===0)return n?-1:0;if(a>4){for(o=r,a<<=3;!((+o^s)&128);)o=+o<<1,--a;o="("+a+` bit)
`}n&&(r=r-256);for(var u=new l.Int10(r),h=e+1;h<t;++h)u.mulAdd(256,this.get(h));return o+u.toString()},i.prototype.parseBitString=function(e,t,r){for(var n=this.get(e),s=(t-e-1<<3)-n,a="("+s+` bit)
`,o="",u=e+1;u<t;++u){for(var h=this.get(u),f=u==t-1?n:0,g=7;g>=f;--g)o+=h>>g&1?"1":"0";if(o.length>r)return a+c(o,r)}return a+o},i.prototype.parseOctetString=function(e,t,r){if(this.isASCII(e,t))return c(this.parseStringISO(e,t),r);var n=t-e,s="("+n+` byte)
`;r/=2,n>r&&(t=e+r);for(var a=e;a<t;++a)s+=this.hexByte(this.get(a));return n>r&&(s+=S),s},i.prototype.parseOID=function(e,t,r){for(var n="",s=new l.Int10,a=0,o=e;o<t;++o){var u=this.get(o);if(s.mulAdd(128,u&127),a+=7,!(u&128)){if(n==="")if(s=s.simplify(),s instanceof l.Int10)s.sub(80),n="2."+s.toString();else{var h=s<80?s<40?0:1:2;n=h+"."+(s-h*40)}else n+="."+s.toString();if(n.length>r)return c(n,r);s=new l.Int10,a=0}}return a>0&&(n+=".incomplete"),n},i}(),E=function(){function i(e,t,r,n,s){if(!(n instanceof d))throw new Error("Invalid tag value.");this.stream=e,this.header=t,this.length=r,this.tag=n,this.sub=s}return i.prototype.typeName=function(){switch(this.tag.tagClass){case 0:switch(this.tag.tagNumber){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString"}return"Universal_"+this.tag.tagNumber.toString();case 1:return"Application_"+this.tag.tagNumber.toString();case 2:return"["+this.tag.tagNumber.toString()+"]";case 3:return"Private_"+this.tag.tagNumber.toString()}},i.prototype.content=function(e){if(this.tag===void 0)return null;e===void 0&&(e=1/0);var t=this.posContent(),r=Math.abs(this.length);if(!this.tag.isUniversal())return this.sub!==null?"("+this.sub.length+" elem)":this.stream.parseOctetString(t,t+r,e);switch(this.tag.tagNumber){case 1:return this.stream.get(t)===0?"false":"true";case 2:return this.stream.parseInteger(t,t+r);case 3:return this.sub?"("+this.sub.length+" elem)":this.stream.parseBitString(t,t+r,e);case 4:return this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(t,t+r,e);case 6:return this.stream.parseOID(t,t+r,e);case 16:case 17:return this.sub!==null?"("+this.sub.length+" elem)":"(no elem)";case 12:return c(this.stream.parseStringUTF(t,t+r),e);case 18:case 19:case 20:case 21:case 22:case 26:return c(this.stream.parseStringISO(t,t+r),e);case 30:return c(this.stream.parseStringBMP(t,t+r),e);case 23:case 24:return this.stream.parseTime(t,t+r,this.tag.tagNumber==23)}return null},i.prototype.toString=function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(this.sub===null?"null":this.sub.length)+"]"},i.prototype.toPrettyString=function(e){e===void 0&&(e="");var t=e+this.typeName()+" @"+this.stream.pos;if(this.length>=0&&(t+="+"),t+=this.length,this.tag.tagConstructed?t+=" (constructed)":this.tag.isUniversal()&&(this.tag.tagNumber==3||this.tag.tagNumber==4)&&this.sub!==null&&(t+=" (encapsulates)"),t+=`
`,this.sub!==null){e+="  ";for(var r=0,n=this.sub.length;r<n;++r)t+=this.sub[r].toPrettyString(e)}return t},i.prototype.posStart=function(){return this.stream.pos},i.prototype.posContent=function(){return this.stream.pos+this.header},i.prototype.posEnd=function(){return this.stream.pos+this.header+Math.abs(this.length)},i.prototype.toHexString=function(){return this.stream.hexDump(this.posStart(),this.posEnd(),!0)},i.decodeLength=function(e){var t=e.get(),r=t&127;if(r==t)return r;if(r>6)throw new Error("Length over 48 bits not supported at position "+(e.pos-1));if(r===0)return null;t=0;for(var n=0;n<r;++n)t=t*256+e.get();return t},i.prototype.getHexStringValue=function(){var e=this.toHexString(),t=this.header*2,r=this.length*2;return e.substr(t,r)},i.decode=function(e){var t;e instanceof p?t=e:t=new p(e,0);var r=new p(t),n=new d(t),s=i.decodeLength(t),a=t.pos,o=a-r.pos,u=null,h=function(){var g=[];if(s!==null){for(var v=a+s;t.pos<v;)g[g.length]=i.decode(t);if(t.pos!=v)throw new Error("Content size is not correct for container starting at offset "+a)}else try{for(;;){var x=i.decode(t);if(x.tag.isEOC())break;g[g.length]=x}s=a-t.pos}catch(b){throw new Error("Exception while decoding undefined length content: "+b)}return g};if(n.tagConstructed)u=h();else if(n.isUniversal()&&(n.tagNumber==3||n.tagNumber==4))try{if(n.tagNumber==3&&t.get()!=0)throw new Error("BIT STRINGs with unused bits cannot encapsulate.");u=h();for(var f=0;f<u.length;++f)if(u[f].tag.isEOC())throw new Error("EOC is not supposed to be actual content.")}catch{u=null}if(u===null){if(s===null)throw new Error("We can't skip over an invalid tag with undefined length at offset "+a);t.pos=a+Math.abs(s)}return new i(r,o,s,n,u)},i}(),d=function(){function i(e){var t=e.get();if(this.tagClass=t>>6,this.tagConstructed=(t&32)!==0,this.tagNumber=t&31,this.tagNumber==31){var r=new l.Int10;do t=e.get(),r.mulAdd(128,t&127);while(t&128);this.tagNumber=r.simplify()}}return i.prototype.isUniversal=function(){return this.tagClass===0},i.prototype.isEOC=function(){return this.tagClass===0&&this.tagNumber===0},i}();exports.ASN1=E;
//# sourceMappingURL=../../../../../../.sourcemap/mp-weixin/uni_modules/jsencrypt/lib/lib/asn1js/asn1.js.map
