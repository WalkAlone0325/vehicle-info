"use strict";const c=require("../../../common/vendor.js"),r=require("./lib/jsbn/base64.js"),s=require("./JSEncryptRSAKey.js");var y,o=typeof process<"u"?(y=process.env)===null||y===void 0?void 0:y.npm_package_version:void 0,p=function(){function t(e){e===void 0&&(e={}),e=e||{},this.default_key_size=e.default_key_size?parseInt(e.default_key_size,10):1024,this.default_public_exponent=e.default_public_exponent||"010001",this.log=e.log||!1,this.key=null}return t.prototype.setKey=function(e){this.log&&this.key&&c.index.__f__("warn","at uni_modules/jsencrypt/lib/JSEncrypt.js:37","A key was already set, overriding existing."),this.key=new s.JSEncryptRSAKey(e)},t.prototype.setPrivateKey=function(e){this.setKey(e)},t.prototype.setPublicKey=function(e){this.setKey(e)},t.prototype.decrypt=function(e){try{return this.getKey().decrypt(r.b64tohex(e))}catch{return!1}},t.prototype.encrypt=function(e){try{return r.hex2b64(this.getKey().encrypt(e))}catch{return!1}},t.prototype.sign=function(e,n,i){try{return r.hex2b64(this.getKey().sign(e,n,i))}catch{return!1}},t.prototype.verify=function(e,n,i){try{return this.getKey().verify(e,r.b64tohex(n),i)}catch{return!1}},t.prototype.getKey=function(e){if(!this.key){if(this.key=new s.JSEncryptRSAKey,e&&{}.toString.call(e)==="[object Function]"){this.key.generateAsync(this.default_key_size,this.default_public_exponent,e);return}this.key.generate(this.default_key_size,this.default_public_exponent)}return this.key},t.prototype.getPrivateKey=function(){return this.getKey().getPrivateKey()},t.prototype.getPrivateKeyB64=function(){return this.getKey().getPrivateBaseKeyB64()},t.prototype.getPublicKey=function(){return this.getKey().getPublicKey()},t.prototype.getPublicKeyB64=function(){return this.getKey().getPublicBaseKeyB64()},t.version=o,t}();exports.JSEncrypt=p;
//# sourceMappingURL=../../../../.sourcemap/mp-weixin/uni_modules/jsencrypt/lib/JSEncrypt.js.map
