{"version":3,"file":"index.js","sources":["utils/index.ts"],"sourcesContent":["import { Decimal } from 'decimal.js'\n\nexport const times = (num1: number, num2: number) => {\n  return new Decimal(num1).times(new Decimal(num2))\n}\n\nexport const getToken = () => uni.getStorageSync('token')\n\nexport const parseTime = (time: number, cFormat: string) => {\n  const format = cFormat || '{y}-{m}-{d} {h}:{i}:{s}'\n  // 时间戳改为日期格式\n  let date: Date\n  if (typeof time === 'object') {\n    date = time\n  }\n  else {\n    date = new Date(parseInt(time))\n  }\n  const formatObj: any = {\n    y: date.getFullYear(),\n    m: date.getMonth() + 1,\n    d: date.getDate(),\n    h: date.getHours(),\n    i: date.getMinutes(),\n    s: date.getSeconds(),\n    a: date.getDay(),\n  }\n  const time_str = format.replace(/{(y|m|d|h|i|s|a)+}/g, (result, key) => {\n    let value = formatObj[key]\n    if (key === 'a')\n      return ['一', '二', '三', '四', '五', '六', '日'][value - 1]\n    if (result.length > 0 && value < 10)\n      value = `0${value}`\n    return value || 0\n  })\n  return time_str\n}\n\nexport function formatDate(cellValue) {\n  if (cellValue == null || cellValue == \"\") return \"\"\n  var date = new Date(cellValue)\n  var year = date.getFullYear()\n  var month = date.getMonth() + 1 < 10 ? '0' + (date.getMonth() + 1) : date.getMonth() + 1\n  var day = date.getDate() < 10 ? '0' + date.getDate() : date.getDate()\n  var hours = date.getHours() < 10 ? '0' + date.getHours() : date.getHours()\n  var minutes = date.getMinutes() < 10 ? '0' + date.getMinutes() : date.getMinutes()\n  var seconds = date.getSeconds() < 10 ? '0' + date.getSeconds() : date.getSeconds()\n  return year + '-' + month + '-' + day + ' ' + hours + ':' + minutes + ':' + seconds\n}\n\nexport function checkRole(data: []) {\n  let result = []\n  const token = uni.getStorageSync('token')\n  if (!token) return\n  const roles = uni.getStorageSync('roles')\n  data.forEach(i => {\n    if(i.role) {\n      if(roles.includes(i.role)){\n        result.push(i)\n      }\n    } else {\n      result.push(i)\n    }\n  })\n  return result\n}\n\nexport function randomRgbColor() {\n  var r = Math.floor(Math.random() * 256)\n  var g = Math.floor(Math.random() * 256)\n  var b = Math.floor(Math.random() * 256)\n  return `rgb(${r},${g},${b})`\n}\n\nconst PI = 3.1415926535897932384626\nconst a = 6378245.0 //卫星椭球坐标投影到平面地图坐标系的投影因子。\nconst ee = 0.00669342162296594323 //椭球的偏心率。\n\n\n//转化经度\nfunction transformlng(lng, lat) {\n  let ret = 300.0 + lng + 2.0 * lat + 0.1 * lng * lng + 0.1 * lng * lat + 0.1 * Math.sqrt(Math.abs(lng))\n  ret += ((20.0 * Math.sin(6.0 * lng * PI) + 20.0 * Math.sin(2.0 * lng * PI)) * 2.0) / 3.0\n  ret += ((20.0 * Math.sin(lng * PI) + 40.0 * Math.sin((lng / 3.0) * PI)) * 2.0) / 3.0\n  ret += ((150.0 * Math.sin((lng / 12.0) * PI) + 300.0 * Math.sin((lng / 30.0) * PI)) * 2.0) / 3.0\n  return ret\n}\n\n//转化纬度\nfunction transformlat(lng, lat) {\n  let ret = -100.0 + 2.0 * lng + 3.0 * lat + 0.2 * lat * lat + 0.1 * lng * lat + 0.2 * Math.sqrt(Math.abs(lng))\n  ret += ((20.0 * Math.sin(6.0 * lng * PI) + 20.0 * Math.sin(2.0 * lng * PI)) * 2.0) / 3.0\n  ret += ((20.0 * Math.sin(lat * PI) + 40.0 * Math.sin((lat / 3.0) * PI)) * 2.0) / 3.0\n  ret += ((160.0 * Math.sin((lat / 12.0) * PI) + 320 * Math.sin((lat * PI) / 30.0)) * 2.0) / 3.0\n  return ret\n}\n//判断时候在国内还是国外\nfunction out_of_china(lon, lat) {\n  if (lon < 72.004 || lon > 137.8347) {\n    return true\n  }\n  if (lat < 0.8293 || lat > 55.8271) {\n    return true\n  }\n  return false\n}\n//wgs84 to gcj02   地球坐标系 转 火星坐标系\nexport function wgs84togcj02(lng, lat) {\n  let dlat = transformlat(lng - 105.0, lat - 35.0)\n  let dlng = transformlng(lng - 105.0, lat - 35.0)\n  let radlat = (lat / 180.0) * PI\n  let magic = Math.sin(radlat)\n  magic = 1 - ee * magic * magic\n  let sqrtmagic = Math.sqrt(magic)\n  dlat =\n    (dlat * 180.0) /\n    (((a * (1 - ee)) / (magic * sqrtmagic)) * PI)\n  dlng =\n    (dlng * 180.0) / ((a / sqrtmagic) * Math.cos(radlat) * PI)\n  let mglat = lat + dlat\n  let mglng = lng + dlng\n\n  return [mglng, mglat]\n}\n\n//gcj02 to wgs84  火星坐标系 转 地球坐标系\nexport function gcj02towgs84(lng, lat) {\n  const originalLngSign = Math.sign(lng)\n  const originalLatSign = Math.sign(lat)\n  lat = Math.abs(lat)\n  lng = Math.abs(lng)\n  let dlat = transformlat(lng - 105.0, lat - 35.0)\n  let dlng = transformlng(lng - 105.0, lat - 35.0)\n  let radlat = lat / 180.0 * PI\n  let magic = Math.sin(radlat)\n  magic = 1 - ee * magic * magic\n  let sqrtmagic = Math.sqrt(magic)\n  dlat = (dlat * 180.0) / ((a * (1 - ee)) / (magic * sqrtmagic) * PI)\n  dlng = (dlng * 180.0) / (a / sqrtmagic * Math.cos(radlat) * PI)\n  let mglat = lat + dlat\n  let mglng = lng + dlng\n  let lngs = lng * 2 - mglng\n  let lats = lat * 2 - mglat\n  let finalLng = originalLngSign * lngs\n  let finalLat = originalLatSign * lats\n\n  return [finalLng, finalLat]\n}\n\nexport function formatDateTime(timestamp) {\n  let date = new Date(timestamp)\n  const year = date.getFullYear()\n  const month = String(date.getMonth() + 1).padStart(2, '0') // 月份从0开始，需加1并补零\n  const day = String(date.getDate()).padStart(2, '0')\n  const hours = String(date.getHours()).padStart(2, '0')\n  const minutes = String(date.getMinutes()).padStart(2, '0')\n  const seconds = String(date.getSeconds()).padStart(2, '0')\n  return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`\n}\n\nexport function getTodayTimestampRange() {\n  const now = new Date();\n  const start = new Date(now);\n  start.setHours(0,  0, 0, 0);\n\n  const end = new Date(now);\n  end.setHours(23,  59, 59, 999);\n\n  return [start.getTime(), end.getTime()]\n}\n\n/**\n* 计算目标日期是多少天前（或几天后）\n* @param {string|Date} targetDate - 目标日期（支持字符串如\"2025-07-01\"或Date对象）\n* @returns {string} 友好提示（如\"9天前\"、\"今天\"、\"1天后\"）\n*/\nexport function getDaysAgo(targetDate) {\n  // 1. 获取当前日期的日起点（00:00:00）\n  const now = new Date()\n  const today = new Date(now.getFullYear(), now.getMonth(), now.getDate())\n\n  // 2. 解析目标日期（处理字符串或Date对象）\n  const target = new Date(targetDate)\n  if (isNaN(target.getTime())) { // 验证日期有效性\n    return \"无效的日期格式，请输入如'2025-07-01'的ISO格式\"\n  }\n  const targetDay = new Date(target.getFullYear(), target.getMonth(), target.getDate())  // 目标日期的日起点\n\n  // 3. 计算时间差（毫秒）并转换为天数\n  const timeDiff = today.getTime() - targetDay.getTime()\n  const daysDiff = Math.floor(timeDiff / 86400000) // 86400000 = 24×60×60×1000\n\n  // 4. 返回友好结果\n  if (daysDiff > 0) {\n    return `${daysDiff}天前`\n  } else if (daysDiff === 0) {\n    return \"今天\"\n  } else {\n    return `${Math.abs(daysDiff)} 天后` // 处理未来日期\n  }\n}\n\n/**\n * 计算距离\n * @param lat1 纬度1\n * @param lng1 经度1\n * @param lat2 纬度2\n * @param lng2 经度2\n * @returns 距离（单位：米）\n */\nfunction rad(d) {\n  return d * Math.PI / 180.0\n}\n\n\n// 根据经纬度计算距离，参数分别为第一点的纬度，经度；第二点的纬度，经度\nexport function getDistance(lat1, lng1, lat2, lng2) {\n\n  var radLat1 = rad(lat1)\n  var radLat2 = rad(lat2)\n  var a = radLat1 - radLat2\n  var b = rad(lng1) - rad(lng2)\n  var s = 2 * Math.asin(Math.sqrt(Math.pow(Math.sin(a / 2), 2) +\n    Math.cos(radLat1) * Math.cos(radLat2) * Math.pow(Math.sin(b / 2), 2)))\n  s = s * 6378.137 // EARTH_RADIUS;\n  // 输出为公里\n  s = Math.round(s * 10000) / 10000\n\n  var distance = s\n  var distance_str = \"\"\n\n  if (parseInt(distance) >= 1) {\n    // distance_str = distance.toFixed(1) + \"km\";\n    distance_str = distance.toFixed(2) + \"km\"\n  } else {\n    // distance_str = distance * 1000 + \"m\";\n    distance_str = (distance * 1000).toFixed(2) + \"m\"\n  }\n\n  //s=s.toFixed(4);\n\n  // console.info('距离是', s);\n  // console.info('距离是', distance_str);\n  // return s;\n\n  //小小修改，这里返回对象\n  let objData = {\n    distance: distance,\n    distance_str: distance_str\n  }\n  return objData.distance_str\n}\n"],"names":["times","num1","num2","Decimal","getToken","uni","parseTime","time","cFormat","format","date","formatObj","result","key","value","formatDate","cellValue","year","month","day","hours","minutes","seconds","checkRole","data","roles","i","randomRgbColor","r","g","b","PI","a","ee","transformlng","lng","lat","ret","transformlat","wgs84togcj02","dlat","dlng","radlat","magic","sqrtmagic","mglat","formatDateTime","timestamp","getTodayTimestampRange","now","start","end","getDaysAgo","targetDate","today","target","targetDay","timeDiff","daysDiff","rad","d","getDistance","lat1","lng1","lat2","lng2","radLat1","radLat2","s","distance","distance_str"],"mappings":"oDAEaA,EAAQ,CAACC,EAAcC,IAC3B,IAAIC,UAAQF,CAAI,EAAE,MAAM,IAAIE,EAAA,QAAQD,CAAI,CAAC,EAGrCE,EAAW,IAAMC,EAAAA,MAAI,eAAe,OAAO,EAE3CC,EAAY,CAACC,EAAcC,IAAoB,CAC1D,MAAMC,EAASD,GAAW,0BAEtB,IAAAE,EACA,OAAOH,GAAS,SACXG,EAAAH,EAGPG,EAAO,IAAI,KAAK,SAASH,CAAI,CAAC,EAEhC,MAAMI,EAAiB,CACrB,EAAGD,EAAK,YAAY,EACpB,EAAGA,EAAK,SAAA,EAAa,EACrB,EAAGA,EAAK,QAAQ,EAChB,EAAGA,EAAK,SAAS,EACjB,EAAGA,EAAK,WAAW,EACnB,EAAGA,EAAK,WAAW,EACnB,EAAGA,EAAK,OAAO,CAAA,EAUV,OARUD,EAAO,QAAQ,sBAAuB,CAACG,EAAQC,IAAQ,CAClE,IAAAC,EAAQH,EAAUE,CAAG,EACzB,OAAIA,IAAQ,IACH,CAAC,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,GAAG,EAAEC,EAAQ,CAAC,GAClDF,EAAO,OAAS,GAAKE,EAAQ,KAC/BA,EAAQ,IAAIA,CAAK,IACZA,GAAS,EAAA,CACjB,CAEH,EAEO,SAASC,EAAWC,EAAW,CAChC,GAAAA,GAAa,MAAQA,GAAa,GAAW,MAAA,GAC7C,IAAAN,EAAO,IAAI,KAAKM,CAAS,EACzBC,EAAOP,EAAK,cACZQ,EAAQR,EAAK,SAAS,EAAI,EAAI,GAAK,KAAOA,EAAK,SAAS,EAAI,GAAKA,EAAK,WAAa,EACnFS,EAAMT,EAAK,QAAA,EAAY,GAAK,IAAMA,EAAK,QAAA,EAAYA,EAAK,QAAQ,EAChEU,EAAQV,EAAK,SAAA,EAAa,GAAK,IAAMA,EAAK,SAAA,EAAaA,EAAK,SAAS,EACrEW,EAAUX,EAAK,WAAA,EAAe,GAAK,IAAMA,EAAK,WAAA,EAAeA,EAAK,WAAW,EAC7EY,EAAUZ,EAAK,WAAA,EAAe,GAAK,IAAMA,EAAK,WAAA,EAAeA,EAAK,WAAW,EAC1E,OAAAO,EAAO,IAAMC,EAAQ,IAAMC,EAAM,IAAMC,EAAQ,IAAMC,EAAU,IAAMC,CAC9E,CAEO,SAASC,EAAUC,EAAU,CAClC,IAAIZ,EAAS,CAAA,EAEb,GAAI,CADUP,EAAAA,MAAI,eAAe,OAAO,EAC5B,OACN,MAAAoB,EAAQpB,EAAAA,MAAI,eAAe,OAAO,EACxC,OAAAmB,EAAK,QAAaE,GAAA,CACbA,EAAE,KACAD,EAAM,SAASC,EAAE,IAAI,GACtBd,EAAO,KAAKc,CAAC,EAGfd,EAAO,KAAKc,CAAC,CACf,CACD,EACMd,CACT,CAEO,SAASe,GAAiB,CAC/B,IAAIC,EAAI,KAAK,MAAM,KAAK,OAAA,EAAW,GAAG,EAClCC,EAAI,KAAK,MAAM,KAAK,OAAA,EAAW,GAAG,EAClCC,EAAI,KAAK,MAAM,KAAK,OAAA,EAAW,GAAG,EACtC,MAAO,OAAOF,CAAC,IAAIC,CAAC,IAAIC,CAAC,GAC3B,CAEA,MAAMC,EAAK,kBACLC,EAAI,QACJC,EAAK,oBAIX,SAASC,EAAaC,EAAKC,EAAK,CAC9B,IAAIC,EAAM,IAAQF,EAAM,EAAMC,EAAM,GAAMD,EAAMA,EAAM,GAAMA,EAAMC,EAAM,GAAM,KAAK,KAAK,KAAK,IAAID,CAAG,CAAC,EACrG,OAAAE,IAAS,GAAO,KAAK,IAAI,EAAMF,EAAMJ,CAAE,EAAI,GAAO,KAAK,IAAI,EAAMI,EAAMJ,CAAE,GAAK,EAAO,EACrFM,IAAS,GAAO,KAAK,IAAIF,EAAMJ,CAAE,EAAI,GAAO,KAAK,IAAKI,EAAM,EAAOJ,CAAE,GAAK,EAAO,EACjFM,IAAS,IAAQ,KAAK,IAAKF,EAAM,GAAQJ,CAAE,EAAI,IAAQ,KAAK,IAAKI,EAAM,GAAQJ,CAAE,GAAK,EAAO,EACtFM,CACT,CAGA,SAASC,EAAaH,EAAKC,EAAK,CAC9B,IAAIC,EAAM,KAAS,EAAMF,EAAM,EAAMC,EAAM,GAAMA,EAAMA,EAAM,GAAMD,EAAMC,EAAM,GAAM,KAAK,KAAK,KAAK,IAAID,CAAG,CAAC,EAC5G,OAAAE,IAAS,GAAO,KAAK,IAAI,EAAMF,EAAMJ,CAAE,EAAI,GAAO,KAAK,IAAI,EAAMI,EAAMJ,CAAE,GAAK,EAAO,EACrFM,IAAS,GAAO,KAAK,IAAID,EAAML,CAAE,EAAI,GAAO,KAAK,IAAKK,EAAM,EAAOL,CAAE,GAAK,EAAO,EACjFM,IAAS,IAAQ,KAAK,IAAKD,EAAM,GAAQL,CAAE,EAAI,IAAM,KAAK,IAAKK,EAAML,EAAM,EAAI,GAAK,EAAO,EACpFM,CACT,CAYgB,SAAAE,EAAaJ,EAAKC,EAAK,CACrC,IAAII,EAAOF,EAAaH,EAAM,IAAOC,EAAM,EAAI,EAC3CK,EAAOP,EAAaC,EAAM,IAAOC,EAAM,EAAI,EAC3CM,EAAUN,EAAM,IAASL,EACzBY,EAAQ,KAAK,IAAID,CAAM,EACnBC,EAAA,EAAIV,EAAKU,EAAQA,EACrB,IAAAC,EAAY,KAAK,KAAKD,CAAK,EAC/BH,EACGA,EAAO,KACLR,GAAK,EAAIC,IAAQU,EAAQC,GAAcb,GAC5CU,EACGA,EAAO,KAAWT,EAAIY,EAAa,KAAK,IAAIF,CAAM,EAAIX,GACzD,IAAIc,EAAQT,EAAMI,EAGX,MAAA,CAFKL,EAAMM,EAEHI,CAAK,CACtB,CA0BO,SAASC,EAAeC,EAAW,CACpC,IAAArC,EAAO,IAAI,KAAKqC,CAAS,EACvB,MAAA9B,EAAOP,EAAK,cACZQ,EAAQ,OAAOR,EAAK,SAAA,EAAa,CAAC,EAAE,SAAS,EAAG,GAAG,EACnDS,EAAM,OAAOT,EAAK,QAAS,CAAA,EAAE,SAAS,EAAG,GAAG,EAC5CU,EAAQ,OAAOV,EAAK,SAAU,CAAA,EAAE,SAAS,EAAG,GAAG,EAC/CW,EAAU,OAAOX,EAAK,WAAY,CAAA,EAAE,SAAS,EAAG,GAAG,EACnDY,EAAU,OAAOZ,EAAK,WAAY,CAAA,EAAE,SAAS,EAAG,GAAG,EAClD,MAAA,GAAGO,CAAI,IAAIC,CAAK,IAAIC,CAAG,IAAIC,CAAK,IAAIC,CAAO,IAAIC,CAAO,EAC/D,CAEO,SAAS0B,GAAyB,CACjC,MAAAC,MAAU,KACVC,EAAQ,IAAI,KAAKD,CAAG,EAC1BC,EAAM,SAAS,EAAI,EAAG,EAAG,CAAC,EAEpB,MAAAC,EAAM,IAAI,KAAKF,CAAG,EACxB,OAAAE,EAAI,SAAS,GAAK,GAAI,GAAI,GAAG,EAEtB,CAACD,EAAM,QAAA,EAAWC,EAAI,QAAS,CAAA,CACxC,CAOO,SAASC,EAAWC,EAAY,CAE/B,MAAAJ,MAAU,KACVK,EAAQ,IAAI,KAAKL,EAAI,YAAA,EAAeA,EAAI,SAAS,EAAGA,EAAI,QAAS,CAAA,EAGjEM,EAAS,IAAI,KAAKF,CAAU,EAClC,GAAI,MAAME,EAAO,QAAQ,CAAC,EACjB,MAAA,iCAEH,MAAAC,EAAY,IAAI,KAAKD,EAAO,YAAA,EAAeA,EAAO,SAAS,EAAGA,EAAO,QAAS,CAAA,EAG9EE,EAAWH,EAAM,QAAQ,EAAIE,EAAU,QAAQ,EAC/CE,EAAW,KAAK,MAAMD,EAAW,KAAQ,EAG/C,OAAIC,EAAW,EACN,GAAGA,CAAQ,KACTA,IAAa,EACf,KAEA,GAAG,KAAK,IAAIA,CAAQ,CAAC,KAEhC,CAUA,SAASC,EAAIC,EAAG,CACP,OAAAA,EAAI,KAAK,GAAK,GACvB,CAIO,SAASC,EAAYC,EAAMC,EAAMC,EAAMC,EAAM,CAE9C,IAAAC,EAAUP,EAAIG,CAAI,EAClBK,EAAUR,EAAIK,CAAI,EAClBhC,EAAIkC,EAAUC,EACdrC,EAAI6B,EAAII,CAAI,EAAIJ,EAAIM,CAAI,EACxBG,EAAI,EAAI,KAAK,KAAK,KAAK,KAAK,KAAK,IAAI,KAAK,IAAIpC,EAAI,CAAC,EAAG,CAAC,EACzD,KAAK,IAAIkC,CAAO,EAAI,KAAK,IAAIC,CAAO,EAAI,KAAK,IAAI,KAAK,IAAIrC,EAAI,CAAC,EAAG,CAAC,CAAC,CAAC,EACvEsC,EAAIA,EAAI,SAERA,EAAI,KAAK,MAAMA,EAAI,GAAK,EAAI,IAE5B,IAAIC,EAAWD,EACXE,EAAe,GAEf,OAAA,SAASD,CAAQ,GAAK,EAETC,EAAAD,EAAS,QAAQ,CAAC,EAAI,KAGrCC,GAAgBD,EAAW,KAAM,QAAQ,CAAC,EAAI,IAUlC,CACZ,SAAAA,EACA,aAAAC,CAAA,EAEa,YACjB"}