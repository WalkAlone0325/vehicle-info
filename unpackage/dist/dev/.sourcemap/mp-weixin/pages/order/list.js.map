{"version":3,"file":"list.js","sources":["pages/order/list.vue","pages/order/list.vue?type=page"],"sourcesContent":["<script setup>\nimport { ref } from 'vue'\nimport { onLoad, onShow } from '@dcloudio/uni-app'\nimport { getApproveApi, getHistoryApi, getApproveListApi, getDoneListApi } from '@/api'\n\nconst MAP_TITLE = {\n  done: '已审批',\n  pending: '待审批',\n  // pass: '已通过',\n  // reject: '已驳回',\n  history: '审批记录',\n  approve: '审批'\n}\nconst curType = ref('')\n// 加载\nonLoad((param) => {\n  curType.value = param.type\n  uni.setNavigationBarTitle({ title: MAP_TITLE[param.type] + '列表' })\n})\n\nconst list = ref([\n  { expectedVehicleId: 1, applicantTime: '2025-05-19 18:38:00', vehicleTypeName: '货车', destination: '116.434446,39.90816长沙市地址', expectedDriverName: '刘洋', expectedPlateNumber: '晋A9NG08' }\n])\nconst total = ref(0)\n\nconst clickDetail = (i) => {\n  uni.navigateTo({\n    url: `/pages/order/form?id=${i.useCarApplicationOrderId}&type=${curType.value}`\n  })\n}\nconst clickRecord = (i) => {\n  uni.navigateTo({\n    url: `/pages/order/record?id=${i.useCarApplicationOrderId}&type=${curType.value}`\n  })\n}\n\nconst clickApply = (i) => {\n  uni.navigateTo({\n    url: `/pages/order/form-apply?id=${i.useCarApplicationOrderId}`\n  })\n}\n\nconst MAP_TYPE = {\n  // 历史\n  history: () => getHistoryApi(),\n  // 审批\n  approve: () => getApproveApi(),\n  // 列表\n  done: (query) => getDoneListApi({...query, orderStatusCode: curType.value}),\n  pending: (query) => getApproveListApi({...query, orderStatusCode: curType.value})\n}\nconst loading = ref(false)\nconst getList = async () => {\n  loading.value = true\n  const res = await MAP_TYPE[curType.value]({\n    pageNum: 1,\n    pageSize: 10\n  })\n  list.value = res.rows\n  total.value = res.total\n  loading.value = false\n}\n\nonShow(() => {\n  getList()\n})\n\nconst getColor = ({orderStatusCode}) => {\n  const MAP_TYPE = {\n    refuse: '#e75356',\n    pass: '#69cea0',\n    draft: '#e28d4b'\n  }\n  return MAP_TYPE[orderStatusCode] || '#69cea0'\n}\n</script>\n\n<template>\n  <view class=\"order-list-page\">\n    <BaseLoading v-if=\"loading\" />\n    <view class=\"list-con\" v-else>\n      <wd-card v-for=\"i in list\" :key=\"i.expectedVehicleId\">\n        <template #title>\n          <view class=\"title\">\n            <view>{{ `时间：${i.applicantTime || ''}` }}</view>\n            <view class=\"title-tip\" v-if=\"i.orderStatusName\" :style=\"{background: getColor(i)}\">\n              {{ i.orderStatusName }}\n            </view>\n          </view>\n        </template>\n\n        <view style=\"display: flex; justify-content: space-between;\">\n          <view style=\"display: flex\">\n            <view class=\"label\">申请人账号：</view>\n            <view class=\"value\">{{ i.applicantUserName }}</view>\n          </view>\n          <view style=\"display: flex\">\n            <view class=\"label\">申请人姓名：</view>\n            <view class=\"value\">{{ i.applicantNickName }}</view>\n          </view>\n        </view>\n\n        <view style=\"display: flex; margin-top: 10rpx;\">\n          <view class=\"label\">申请人公司：</view>\n          <view class=\"value\">{{ i.applicantDeptName }}</view>\n        </view>\n\n        <view style=\"display: flex; margin-top: 10rpx;\">\n          <view class=\"label\">申请人部门：</view>\n            <view class=\"value\">{{ i.applicantCompanyDeptName }}</view>\n        </view>\n\n\n        <view style=\"display: flex; justify-content: space-between; margin-top: 10rpx;\">\n          <view style=\"display: flex\">\n            <view class=\"label\">是否跨市：</view>\n            <view class=\"value\">{{ i.applicantIsIntermarketCityName }}</view>\n          </view>\n          <view style=\"display: flex\">\n            <view class=\"label\">乘车人数：</view>\n            <view class=\"value\">{{ i.applicantPassengersNumber }}</view>\n          </view>\n        </view>\n\n        <view style=\"display: flex; margin-top: 10rpx;\">\n          <view class=\"label\">申请内容：</view>\n          <view class=\"value\">{{ i.applicantContent }}</view>\n        </view>\n        <template #footer>\n          <view class=\"footer\">\n            <view style=\"display: flex\">\n              <wd-tag type=\"primary\" mark v-if=\"i.vehicleTypeName\">{{ i.vehicleTypeName }}</wd-tag>\n            </view>\n            <view style=\"display: flex;\">\n              <wd-button v-if=\"curType === 'pass'\" size=\"small\" plain type=\"success\"\n                @click=\"clickApply(i)\">申请费用</wd-button>\n              <view style=\"margin-right: 20rpx;\"></view>\n              <!-- <wd-button size=\"small\" plain @click=\"clickImg(i)\">流程图</wd-button>\n              <view style=\"margin-right: 20rpx;\"></view> -->\n              <wd-button size=\"small\" plain @click=\"clickDetail(i)\">审批</wd-button>\n              <view style=\"margin-right: 20rpx;\"></view>\n              <wd-button size=\"small\" plain @click=\"clickRecord(i)\">审批记录</wd-button>\n            </view>\n          </view>\n        </template>\n      </wd-card>\n    </view>\n    <wd-status-tip v-if=\"!loading && total == 0\" image=\"/static/content.png\" tip=\"暂无列表\" />\n  </view>\n</template>\n\n<style lang=\"scss\" scoped>\n.order-list-page {\n  .list-con {\n    padding-top: 30rpx;\n\n    .title {\n      display: flex;\n      justify-content: space-between;\n\n      .title-tip {\n        padding: 8rpx 6rpx;\n        border-radius: 6rpx;\n        color: #fff;\n        font-size: 24rpx;\n      }\n    }\n\n    .value {\n      color: #333;\n    }\n\n    .footer {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n    }\n\n    ::v-deep .wd-card__footer {\n      padding: 24rpx 0 14rpx;\n    }\n\n    ::v-deep .wd-tag {\n      font-size: 12px;\n    }\n  }\n}\n</style>\n","import MiniProgramPage from '/Users/jing/Code/mini/vehicle-info/pages/order/list.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","onLoad","uni","getHistoryApi","getApproveApi","getDoneListApi","getApproveListApi","onShow","MAP_TYPE"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAKA,UAAM,YAAY;AAAA,MAChB,MAAM;AAAA,MACN,SAAS;AAAA;AAAA;AAAA,MAGT,SAAS;AAAA,MACT,SAAS;AAAA,IACX;AACA,UAAM,UAAUA,cAAG,IAAC,EAAE;AAEtBC,kBAAM,OAAC,CAAC,UAAU;AAChB,cAAQ,QAAQ,MAAM;AACtBC,0BAAI,sBAAsB,EAAE,OAAO,UAAU,MAAM,IAAI,IAAI,MAAM;AAAA,IACnE,CAAC;AAED,UAAM,OAAOF,cAAAA,IAAI;AAAA,MACf,EAAE,mBAAmB,GAAG,eAAe,uBAAuB,iBAAiB,MAAM,aAAa,4BAA4B,oBAAoB,MAAM,qBAAqB,UAAW;AAAA,IAC1L,CAAC;AACD,UAAM,QAAQA,cAAG,IAAC,CAAC;AAEnB,UAAM,cAAc,CAAC,MAAM;AACzBE,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK,wBAAwB,EAAE,wBAAwB,SAAS,QAAQ,KAAK;AAAA,MACjF,CAAG;AAAA,IACH;AACA,UAAM,cAAc,CAAC,MAAM;AACzBA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK,0BAA0B,EAAE,wBAAwB,SAAS,QAAQ,KAAK;AAAA,MACnF,CAAG;AAAA,IACH;AAEA,UAAM,aAAa,CAAC,MAAM;AACxBA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK,8BAA8B,EAAE,wBAAwB;AAAA,MACjE,CAAG;AAAA,IACH;AAEA,UAAM,WAAW;AAAA;AAAA,MAEf,SAAS,MAAMC,UAAAA,cAAe;AAAA;AAAA,MAE9B,SAAS,MAAMC,UAAAA,cAAe;AAAA;AAAA,MAE9B,MAAM,CAAC,UAAUC,yBAAe,EAAC,GAAG,OAAO,iBAAiB,QAAQ,MAAK,CAAC;AAAA,MAC1E,SAAS,CAAC,UAAUC,4BAAkB,EAAC,GAAG,OAAO,iBAAiB,QAAQ,MAAK,CAAC;AAAA,IAClF;AACA,UAAM,UAAUN,cAAG,IAAC,KAAK;AACzB,UAAM,UAAU,YAAY;AAC1B,cAAQ,QAAQ;AAChB,YAAM,MAAM,MAAM,SAAS,QAAQ,KAAK,EAAE;AAAA,QACxC,SAAS;AAAA,QACT,UAAU;AAAA,MACd,CAAG;AACD,WAAK,QAAQ,IAAI;AACjB,YAAM,QAAQ,IAAI;AAClB,cAAQ,QAAQ;AAAA,IAClB;AAEAO,kBAAAA,OAAO,MAAM;AACX,cAAS;AAAA,IACX,CAAC;AAED,UAAM,WAAW,CAAC,EAAC,gBAAe,MAAM;AACtC,YAAMC,YAAW;AAAA,QACf,QAAQ;AAAA,QACR,MAAM;AAAA,QACN,OAAO;AAAA,MACR;AACD,aAAOA,UAAS,eAAe,KAAK;AAAA,IACtC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzEA,GAAG,WAAW,eAAe;"}