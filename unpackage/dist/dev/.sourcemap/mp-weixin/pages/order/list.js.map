{"version":3,"file":"list.js","sources":["pages/order/list.vue","pages/order/list.vue?type=page"],"sourcesContent":["<script setup>\nimport { ref } from 'vue'\nimport { onLoad, onShow } from '@dcloudio/uni-app'\nimport { getApproveApi, getHistoryApi, getApproveListApi, getDoneListApi } from '@/api'\n\nconst MAP_TITLE = {\n  done: '已审批',\n  pending: '待审批',\n  // pass: '已通过',\n  // reject: '已驳回',\n  history: '审批记录',\n  approve: '审批'\n}\nconst btnText = ref('查看')\nconst curType = ref('')\n// 加载\nonLoad((param) => {\n  curType.value = param.type\n  btnText.value = param.type == 'approve' ? '审批' : '查看'\n  console.log(btnText.value, param.type)\n  uni.setNavigationBarTitle({ title: MAP_TITLE[param.type] + '列表' })\n})\n\nconst list = ref([\n  { expectedVehicleId: 1, applicantTime: '2025-05-19 18:38:00', vehicleTypeName: '货车', destination: '116.434446,39.90816长沙市地址', expectedDriverName: '刘洋', expectedPlateNumber: '晋A9NG08' }\n])\nconst total = ref(0)\n\nconst clickDetail = (i) => {\n  uni.navigateTo({\n    url: `/pages/order/form?id=${i.useCarApplicationOrderId}&type=${curType.value}`\n  })\n}\nconst clickRecord = (i) => {\n  uni.navigateTo({\n    url: `/pages/order/record?id=${i.useCarApplicationOrderId}&type=${curType.value}`\n  })\n}\n\nconst clickApply = (i) => {\n  uni.navigateTo({\n    url: `/pages/order/form-apply?id=${i.useCarApplicationOrderId}`\n  })\n}\n\nconst MAP_TYPE = {\n  // 历史\n  history: () => getHistoryApi(),\n  // 审批\n  approve: () => getApproveApi(),\n  // 列表\n  done: (query) => getDoneListApi({...query, orderStatusCode: curType.value}),\n  pending: (query) => getApproveListApi({...query, orderStatusCode: curType.value})\n}\nconst loading = ref(false)\nconst getList = async () => {\n  loading.value = true\n  const res = await MAP_TYPE[curType.value]({\n    pageNum: 1,\n    pageSize: 99\n  })\n  list.value = res.rows\n  total.value = res.total\n  loading.value = false\n}\n\nonShow(() => {\n  getList()\n})\n\nconst getColor = ({orderStatusCode}) => {\n  const MAP_TYPE = {\n    refuse: '#e75356',\n    pass: '#69cea0',\n    draft: '#e28d4b'\n  }\n  return MAP_TYPE[orderStatusCode] || '#69cea0'\n}\n</script>\n\n<template>\n  <view class=\"order-list-page\">\n    <BaseLoading v-if=\"loading\" />\n    <view class=\"list-con\" v-else>\n      <wd-card v-for=\"i in list\" :key=\"i.expectedVehicleId\">\n        <template #title>\n          <view class=\"title\">\n            <view>{{ `时间：${i.applicantTime || ''}` }}</view>\n            <view class=\"title-tip\" v-if=\"i.orderStatusName\" :style=\"{background: getColor(i)}\">\n              {{ i.orderStatusName }}\n            </view>\n          </view>\n        </template>\n\n        <view style=\"display: flex; justify-content: space-between;\">\n          <view style=\"display: flex\">\n            <view class=\"label\">申请人账号：</view>\n            <view class=\"value\">{{ i.applicantUserName }}</view>\n          </view>\n          <view style=\"display: flex\">\n            <view class=\"label\">申请人姓名：</view>\n            <view class=\"value\">{{ i.applicantNickName }}</view>\n          </view>\n        </view>\n\n        <view style=\"display: flex; margin-top: 10rpx;\">\n          <view class=\"label\">申请人公司：</view>\n          <view class=\"value\">{{ i.applicantDeptName }}</view>\n        </view>\n\n        <view style=\"display: flex; margin-top: 10rpx;\">\n          <view class=\"label\">申请人部门：</view>\n            <view class=\"value\">{{ i.applicantCompanyDeptName }}</view>\n        </view>\n\n\n        <view style=\"display: flex; justify-content: space-between; margin-top: 10rpx;\">\n          <view style=\"display: flex\">\n            <view class=\"label\">是否跨市：</view>\n            <view class=\"value\">{{ i.applicantIsIntermarketCityName }}</view>\n          </view>\n          <view style=\"display: flex\">\n            <view class=\"label\">乘车人数：</view>\n            <view class=\"value\">{{ i.applicantPassengersNumber }}</view>\n          </view>\n        </view>\n\n        <view style=\"display: flex; margin-top: 10rpx;\">\n          <view class=\"label\">申请内容：</view>\n          <view class=\"value\">{{ i.applicantContent }}</view>\n        </view>\n        <template #footer>\n          <view class=\"footer\">\n            <view style=\"display: flex\">\n              <wd-tag type=\"primary\" mark v-if=\"i.vehicleTypeName\">{{ i.vehicleTypeName }}</wd-tag>\n            </view>\n            <view style=\"display: flex;\">\n              <wd-button v-if=\"curType === 'pass'\" size=\"small\" plain type=\"success\"\n                @click=\"clickApply(i)\">申请费用</wd-button>\n              <view style=\"margin-right: 20rpx;\"></view>\n              <!-- <wd-button size=\"small\" plain @click=\"clickImg(i)\">流程图</wd-button>\n              <view style=\"margin-right: 20rpx;\"></view> -->\n              <wd-button size=\"small\" plain @click=\"clickDetail(i)\">{{btnText}}</wd-button>\n              <view style=\"margin-right: 20rpx;\"></view>\n              <wd-button size=\"small\" plain @click=\"clickRecord(i)\">审批记录</wd-button>\n            </view>\n          </view>\n        </template>\n      </wd-card>\n    </view>\n    <wd-status-tip v-if=\"!loading && total == 0\" image=\"/static/content.png\" tip=\"暂无列表\" />\n  </view>\n</template>\n\n<style lang=\"scss\" scoped>\n.order-list-page {\n  .list-con {\n    padding-top: 30rpx;\n\n    .title {\n      display: flex;\n      justify-content: space-between;\n\n      .title-tip {\n        padding: 8rpx 6rpx;\n        border-radius: 6rpx;\n        color: #fff;\n        font-size: 24rpx;\n      }\n    }\n\n    .value {\n      color: #333;\n    }\n\n    .footer {\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n    }\n\n    ::v-deep .wd-card__footer {\n      padding: 24rpx 0 14rpx;\n    }\n\n    ::v-deep .wd-tag {\n      font-size: 12px;\n    }\n  }\n}\n</style>\n","import MiniProgramPage from '/Users/jing/Code/mini/vehicle-info/pages/order/list.vue'\nwx.createPage(MiniProgramPage)"],"names":["MAP_TITLE","btnText","ref","curType","onLoad","param","uni","list","total","clickDetail","i","clickRecord","clickApply","MAP_TYPE","getHistoryApi","getApproveApi","query","getDoneListApi","getApproveListApi","loading","getList","res","onShow","getColor","orderStatusCode","MiniProgramPage"],"mappings":"qtBAKA,MAAMA,EAAY,CAChB,KAAM,MACN,QAAS,MAGT,QAAS,OACT,QAAS,IACX,EACMC,EAAUC,EAAG,IAAC,IAAI,EAClBC,EAAUD,EAAG,IAAC,EAAE,EAEtBE,EAAM,OAAEC,GAAU,CAChBF,EAAQ,MAAQE,EAAM,KACtBJ,EAAQ,MAAQI,EAAM,MAAQ,UAAY,KAAO,KACjDC,EAAY,MAAA,MAAA,MAAA,6BAAAL,EAAQ,MAAOI,EAAM,IAAI,EACrCC,QAAI,sBAAsB,CAAE,MAAON,EAAUK,EAAM,IAAI,EAAI,KAAM,CACnE,CAAC,EAED,MAAME,EAAOL,EAAAA,IAAI,CACf,CAAE,kBAAmB,EAAG,cAAe,sBAAuB,gBAAiB,KAAM,YAAa,2BAA4B,mBAAoB,KAAM,oBAAqB,SAAW,CAC1L,CAAC,EACKM,EAAQN,EAAG,IAAC,CAAC,EAEbO,EAAeC,GAAM,CACzBJ,EAAAA,MAAI,WAAW,CACb,IAAK,wBAAwBI,EAAE,wBAAwB,SAASP,EAAQ,KAAK,EACjF,CAAG,CACH,EACMQ,EAAeD,GAAM,CACzBJ,EAAAA,MAAI,WAAW,CACb,IAAK,0BAA0BI,EAAE,wBAAwB,SAASP,EAAQ,KAAK,EACnF,CAAG,CACH,EAEMS,EAAcF,GAAM,CACxBJ,EAAAA,MAAI,WAAW,CACb,IAAK,8BAA8BI,EAAE,wBAAwB,EACjE,CAAG,CACH,EAEMG,EAAW,CAEf,QAAS,IAAMC,EAAAA,cAAe,EAE9B,QAAS,IAAMC,EAAAA,cAAe,EAE9B,KAAOC,GAAUC,iBAAe,CAAC,GAAGD,EAAO,gBAAiBb,EAAQ,KAAK,CAAC,EAC1E,QAAUa,GAAUE,oBAAkB,CAAC,GAAGF,EAAO,gBAAiBb,EAAQ,KAAK,CAAC,CAClF,EACMgB,EAAUjB,EAAG,IAAC,EAAK,EACnBkB,EAAU,SAAY,CAC1BD,EAAQ,MAAQ,GAChB,MAAME,EAAM,MAAMR,EAASV,EAAQ,KAAK,EAAE,CACxC,QAAS,EACT,SAAU,EACd,CAAG,EACDI,EAAK,MAAQc,EAAI,KACjBb,EAAM,MAAQa,EAAI,MAClBF,EAAQ,MAAQ,EAClB,EAEAG,EAAAA,OAAO,IAAM,CACXF,EAAS,CACX,CAAC,EAED,MAAMG,EAAW,CAAC,CAAC,gBAAAC,CAAe,KACf,CACf,OAAQ,UACR,KAAM,UACN,MAAO,SACR,GACeA,CAAe,GAAK,inCC3EtC,GAAG,WAAWC,CAAe"}