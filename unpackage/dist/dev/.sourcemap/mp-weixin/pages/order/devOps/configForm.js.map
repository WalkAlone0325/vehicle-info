{"version":3,"file":"configForm.js","sources":["pages/order/devOps/configForm.vue","pages/order/devOps/configForm.vue?type=page"],"sourcesContent":["<script setup>\nimport { ref } from 'vue'\nimport { getConfigDetail, getDictApi, putConfigDetail, postConfigDetail } from '@/api'\nimport { onLoad } from '@dcloudio/uni-app'\n\nconst options = ref([])\nconst loading = ref(false)\nconst form = ref(null)\nconst model = ref({\n  maintenanceRecordTypeCode: '',\n  maintenanceWarningFrontDay: '',\n  remark: '',\n  maintenanceWarningCycleId: ''\n})\nconst rules = ref({\n  maintenanceRecordTypeCode: [\n    { required: true, message: '请选择保养类型' },\n  ],\n  maintenanceWarningFrontDay: [\n    { required: true, message: '请输入提前告警时间（日）' },\n    { min: 1, message: '提前告警时间（日）不能小于1' },\n    { max: 365, message: '提前告警时间（日）不能大于365' }\n  ]\n})\nconst getDetail = async (id) => {\n  const res = await getConfigDetail(id)\n  model.value = res.data\n}\n\nconst getDict = async (code) => {\n  const res = await getDictApi(code)\n  options.value = res.data\n}\n\nconst handleSubmit = () => {\n  form.value\n    .validate()\n    .then(async ({ valid, errors }) => {\n      if (valid) {\n        loading.value = true\n        // 提交表单数据\n        let res\n        if (model.value.maintenanceWarningCycleId) {\n          res = await putConfigDetail(model.value)\n        } else {\n          res = await postConfigDetail(model.value)\n        }\n        if (res.code == 200) {\n          uni.showToast({\n            title: '提交成功',\n            icon: 'success',\n            duration: 1000,\n            success: () => {\n              setTimeout(() => {\n                loading.value = false\n                uni.navigateBack({\n                  delta: 1\n                })\n              }, 1000)\n            }\n          })\n        }\n        loading.value = false\n      }\n    })\n    .catch((error) => {\n      console.log(error, 'error')\n    })\n}\n\nonLoad((param) => {\n  if (param.id) {\n    getDetail(param.id)\n  }\n  getDict('vehicle_maintenance_record_type')\n})\n</script>\n\n<template>\n  <view class=\"info-page\">\n    <BaseForm>\n      <view class=\"form-con\">\n        <wd-form ref=\"form\" :model=\"model\" :rules=\"rules\" errorType=\"toast\">\n          <wd-cell-group border>\n            <wd-picker label=\"保养类型\" placeholder=\"请选择保养类型\" value-key=\"dictValue\" label-key=\"dictLabel\" label-width=\"120px\"\n              prop=\"maintenanceRecordTypeCode\" v-model=\"model.maintenanceRecordTypeCode\" :columns=\"options\" />\n            <wd-input type=\"number\" label=\"提前告警时间(日)\" label-width=\"120px\" prop=\"maintenanceWarningFrontDay\" required\n              v-model=\"model.maintenanceWarningFrontDay\" placeholder=\"请输入提前告警时间（日）\" />\n            <wd-input label=\"备注\" label-width=\"100px\" prop=\"remark\" clearable v-model=\"model.remark\" placeholder=\"请输入备注\" />\n          </wd-cell-group>\n          <view class=\"footer\">\n            <wd-button type=\"primary\" :loading=\"loading\" block @click=\"handleSubmit\">保存</wd-button>\n          </view>\n        </wd-form>\n      </view>\n    </BaseForm>\n  </view>\n</template>\n\n<style lang=\"scss\" scoped>\n.info-page {\n  .footer {\n    padding: 30rpx;\n    margin-top: 30rpx;\n  }\n\n  .form-con {\n    height: 30vh;\n    background-color: #fff;\n  }\n}\n</style>\n","import MiniProgramPage from '/Users/jing/Code/mini/vehicle-info/pages/order/devOps/configForm.vue'\nwx.createPage(MiniProgramPage)"],"names":["options","ref","loading","form","model","rules","getDetail","id","res","getConfigDetail","getDict","code","getDictApi","handleSubmit","valid","errors","putConfigDetail","postConfigDetail","uni","error","onLoad","param","MiniProgramPage"],"mappings":"24BAKA,MAAMA,EAAUC,EAAG,IAAC,EAAE,EAChBC,EAAUD,EAAG,IAAC,EAAK,EACnBE,EAAOF,EAAG,IAAC,IAAI,EACfG,EAAQH,EAAAA,IAAI,CAChB,0BAA2B,GAC3B,2BAA4B,GAC5B,OAAQ,GACR,0BAA2B,EAC7B,CAAC,EACKI,EAAQJ,EAAAA,IAAI,CAChB,0BAA2B,CACzB,CAAE,SAAU,GAAM,QAAS,SAAW,CACvC,EACD,2BAA4B,CAC1B,CAAE,SAAU,GAAM,QAAS,cAAgB,EAC3C,CAAE,IAAK,EAAG,QAAS,gBAAkB,EACrC,CAAE,IAAK,IAAK,QAAS,kBAAoB,CAC1C,CACH,CAAC,EACKK,EAAY,MAAOC,GAAO,CAC9B,MAAMC,EAAM,MAAMC,EAAe,gBAACF,CAAE,EACpCH,EAAM,MAAQI,EAAI,IACpB,EAEME,EAAU,MAAOC,GAAS,CAC9B,MAAMH,EAAM,MAAMI,EAAU,WAACD,CAAI,EACjCX,EAAQ,MAAQQ,EAAI,IACtB,EAEMK,EAAe,IAAM,CACzBV,EAAK,MACF,SAAU,EACV,KAAK,MAAO,CAAE,MAAAW,EAAO,OAAAC,KAAa,CACjC,GAAID,EAAO,CACTZ,EAAQ,MAAQ,GAEhB,IAAIM,EACAJ,EAAM,MAAM,0BACdI,EAAM,MAAMQ,EAAAA,gBAAgBZ,EAAM,KAAK,EAEvCI,EAAM,MAAMS,EAAAA,iBAAiBb,EAAM,KAAK,EAEtCI,EAAI,MAAQ,KACdU,EAAAA,MAAI,UAAU,CACZ,MAAO,OACP,KAAM,UACN,SAAU,IACV,QAAS,IAAM,CACb,WAAW,IAAM,CACfhB,EAAQ,MAAQ,GAChBgB,EAAAA,MAAI,aAAa,CACf,MAAO,CACzB,CAAiB,CACF,EAAE,GAAI,CACR,CACb,CAAW,EAEHhB,EAAQ,MAAQ,EACjB,CACP,CAAK,EACA,MAAOiB,GAAU,CAChBD,EAAAA,MAAY,MAAA,MAAA,0CAAAC,EAAO,OAAO,CAChC,CAAK,CACL,EAEAC,OAAAA,EAAM,OAAEC,GAAU,CACZA,EAAM,IACRf,EAAUe,EAAM,EAAE,EAEpBX,EAAQ,iCAAiC,CAC3C,CAAC,s2BC1ED,GAAG,WAAWY,CAAe"}