{"version":3,"file":"planForm.js","sources":["pages/order/devOps/planForm.vue","pages/order/devOps/planForm.vue?type=page"],"sourcesContent":["<script setup>\nimport { ref } from 'vue'\nimport { getPlanDetail, updatePlan } from '@/api'\nimport { onLoad } from '@dcloudio/uni-app'\n\nconst loading = ref(false)\nconst form = ref(null)\nconst model = ref({\n  vehicleId: '',\n  plateNumber: '', // 车拍\n  remark: '',\n  lastMaintenance: '', // 上次保养日期\n  nextMaintenance: '', // 下次保养日期\n  lastInspection: '', // 上次年检日期\n  nextInspection: '', // 下次年检日期\n  lastInsurance: '', // 上次保险日期\n  nextInsurance: '' // 下次保险日期\n})\nconst rules = ref({\n  vehicleId: [\n    { required: true, message: '请选择车辆车牌' }\n  ],\n  // lastMaintenance: [\n  //   { required: true, message: '请选择上次保养日期' }\n  // ], // 上次保养日期\n  // nextMaintenance: [\n  //   { required: true, message: '请选择下次保养日期' }\n  // ], // 下次保养日期\n  // lastInspection: [\n  //   { required: true, message: '请选择上次年检日期' }\n  // ], // 上次年检日期\n  // nextInspection: [\n  //   { required: true, message: '请选择下次年检日期' }\n  // ], // 下次年检日期\n  // lastInsurance: [\n  //   { required: true, message: '请选择上次保险日期' }\n  // ], // 上次保险日期\n  // nextInsurance: [\n  //   { required: true, message: '请选择下次保险日期' }\n  // ] // 下次保险日期\n})\n\nconst getDetail = async (id) => {\n  const res = await getPlanDetail(id)\n  model.value = res.data\n}\n\n\nconst handleSubmit = () => {\n  form.value\n    .validate()\n    .then(async ({ valid, errors }) => {\n      if (valid) {\n        loading.value = true\n        // 提交表单数据\n        const res = await updatePlan(model.value)\n        if (res.code == 200) {\n          uni.showToast({\n            title: '提交成功',\n            icon: 'success',\n            duration: 1000,\n            success: () => {\n              setTimeout(() => {\n                loading.value = false\n                uni.navigateBack({\n                  delta: 1\n                })\n              }, 1000)\n            }\n          })\n        }\n        loading.value = false\n      }\n    })\n    .catch((error) => {\n      console.log(error, 'error')\n    })\n}\n\nonLoad((param) => {\n  if (param.id) {\n    getDetail(param.id)\n  }\n})\n</script>\n\n<template>\n  <view class=\"info-page\">\n    <BaseForm>\n      <wd-form ref=\"form\" :model=\"model\" :rules=\"rules\" errorType=\"toast\">\n        <wd-cell-group border>\n          <wd-input clearable label=\"车辆车牌\" label-width=\"100px\" prop=\"plateNumber\" :disabled=\"true\" v-model=\"model.plateNumber\" placeholder=\"请输入备注\" />\n\n          <wd-datetime-picker clearable label=\"上次保养日期\" type=\"date\" label-width=\"100px\" placeholder=\"请选择日期\" prop=\"lastMaintenance\" v-model=\"model.lastMaintenance\" />\n          <wd-datetime-picker clearable label=\"下次保养日期\" type=\"date\" label-width=\"100px\" placeholder=\"请选择日期\" prop=\"nextMaintenance\" v-model=\"model.nextMaintenance\" />\n\n          <wd-datetime-picker clearable label=\"上次年检日期\" type=\"date\" label-width=\"100px\" placeholder=\"请选择日期\" prop=\"lastInspection\" v-model=\"model.lastInspection\" />\n          <wd-datetime-picker clearable label=\"下次年检日期\" type=\"date\" label-width=\"100px\" placeholder=\"请选择日期\" prop=\"nextInspection\" v-model=\"model.nextInspection\" />\n\n          <wd-datetime-picker clearable label=\"上次保险日期\" type=\"date\" label-width=\"100px\" placeholder=\"请选择日期\" prop=\"lastInsurance\" v-model=\"model.lastInsurance\" />\n          <wd-datetime-picker clearable label=\"下次保险日期\" type=\"date\" label-width=\"100px\" placeholder=\"请选择日期\" prop=\"nextInsurance\" v-model=\"model.nextInsurance\" />\n\n          <wd-input label=\"备注\" label-width=\"100px\" prop=\"remark\" clearable v-model=\"model.remark\" placeholder=\"请输入备注\" />\n\n        </wd-cell-group>\n        <view class=\"footer\">\n          <wd-button type=\"primary\" :loading=\"loading\" block @click=\"handleSubmit\">保存</wd-button>\n        </view>\n      </wd-form>\n    </BaseForm>\n  </view>\n</template>\n\n<style lang=\"scss\" scoped>\n.info-page {\n  .footer {\n    padding: 30rpx;\n  }\n}\n</style>\n","import MiniProgramPage from '/Users/jing/Code/mini/vehicle-info/pages/order/devOps/planForm.vue'\nwx.createPage(MiniProgramPage)"],"names":["loading","ref","form","model","rules","getDetail","id","res","getPlanDetail","handleSubmit","valid","errors","updatePlan","uni","error","onLoad","param","MiniProgramPage"],"mappings":"g4BAKA,MAAMA,EAAUC,EAAG,IAAC,EAAK,EACnBC,EAAOD,EAAG,IAAC,IAAI,EACfE,EAAQF,EAAAA,IAAI,CAChB,UAAW,GACX,YAAa,GACb,OAAQ,GACR,gBAAiB,GACjB,gBAAiB,GACjB,eAAgB,GAChB,eAAgB,GAChB,cAAe,GACf,cAAe,EACjB,CAAC,EACKG,EAAQH,EAAAA,IAAI,CAChB,UAAW,CACT,CAAE,SAAU,GAAM,QAAS,SAAW,CACvC,CAmBH,CAAC,EAEKI,EAAY,MAAOC,GAAO,CAC9B,MAAMC,EAAM,MAAMC,EAAa,cAACF,CAAE,EAClCH,EAAM,MAAQI,EAAI,IACpB,EAGME,EAAe,IAAM,CACzBP,EAAK,MACF,SAAU,EACV,KAAK,MAAO,CAAE,MAAAQ,EAAO,OAAAC,KAAa,CAC7BD,IACFV,EAAQ,MAAQ,IAEJ,MAAMY,aAAWT,EAAM,KAAK,GAChC,MAAQ,KACdU,EAAAA,MAAI,UAAU,CACZ,MAAO,OACP,KAAM,UACN,SAAU,IACV,QAAS,IAAM,CACb,WAAW,IAAM,CACfb,EAAQ,MAAQ,GAChBa,EAAAA,MAAI,aAAa,CACf,MAAO,CACzB,CAAiB,CACF,EAAE,GAAI,CACR,CACb,CAAW,EAEHb,EAAQ,MAAQ,GAExB,CAAK,EACA,MAAOc,GAAU,CAChBD,EAAAA,MAAY,MAAA,MAAA,wCAAAC,EAAO,OAAO,CAChC,CAAK,CACL,EAEAC,OAAAA,EAAM,OAAEC,GAAU,CACZA,EAAM,IACRX,EAAUW,EAAM,EAAE,CAEtB,CAAC,knDClFD,GAAG,WAAWC,CAAe"}