{"version":3,"file":"form.js","sources":["pages/order/devOps/form.vue","pages/order/devOps/form.vue?type=page"],"sourcesContent":["<script setup>\nimport { ref } from 'vue'\nimport { getConfigDetail, getDictApi, putConfigDetail, postConfigDetail } from '@/api'\nimport { onLoad } from '@dcloudio/uni-app'\n\nconst options = ref([])\nconst loading = ref(false)\nconst form = ref(null)\nconst model = ref({\n  maintenanceRecordTypeCode: '',\n  maintenanceWarningFrontDay: '',\n  remark: '',\n  maintenanceWarningCycleId: ''\n})\nconst rules = ref({\n  maintenanceRecordTypeCode: [\n    { required: true, message: '请选择保养类型' },\n  ],\n  maintenanceWarningFrontDay: [\n    { required: true, message: '请输入提前告警时间（日）' },\n    { min: 1, message: '提前告警时间（日）不能小于1' },\n    { max: 365, message: '提前告警时间（日）不能大于365' }\n  ]\n})\nconst getDetail = async (id) => {\n  const res = await getConfigDetail(id)\n  model.value = res.data\n}\n\nconst getDict = async (code) => {\n  const res = await getDictApi(code)\n  options.value = res.data\n}\n\nconst handleSubmit = () => {\n  form.value\n    .validate()\n    .then(async ({ valid, errors }) => {\n      if (valid) {\n        loading.value = true\n        // 提交表单数据\n        let res\n        if (model.value.maintenanceWarningCycleId) {\n          res = await putConfigDetail(model.value)\n        } else {\n          res = await postConfigDetail(model.value)\n        }\n        if (res.code == 200) {\n          uni.showToast({\n            title: '提交成功',\n            icon: 'success',\n            duration: 2000,\n            success: () => {\n              setTimeout(() => {\n                loading.value = false\n                uni.navigateBack({\n                  delta: 1\n                })\n              }, 2000)\n            }\n          })\n        }\n        loading.value = false\n      }\n    })\n    .catch((error) => {\n      console.log(error, 'error')\n    })\n}\n\nonLoad((param) => {\n  if (param.id) {\n    getDetail(param.id)\n  }\n  getDict('vehicle_maintenance_record_type')\n})\n</script>\n\n<template>\n  <view class=\"info-page\">\n    <wd-form ref=\"form\" :model=\"model\" :rules=\"rules\">\n      <wd-picker label=\"保养类型\" placeholder=\"请选择保养类型\" value-key=\"dictValue\" label-key=\"dictLabel\" label-width=\"120px\"\n        prop=\"maintenanceRecordTypeCode\" v-model=\"model.maintenanceRecordTypeCode\" :columns=\"options\" />\n      <wd-input type=\"number\" label=\"提前告警时间(日)\" label-width=\"120px\" prop=\"maintenanceWarningFrontDay\" required\n        v-model=\"model.maintenanceWarningFrontDay\" placeholder=\"请输入提前告警时间（日）\" />\n      <wd-input label=\"备注\" label-width=\"100px\" prop=\"remark\" clearable v-model=\"model.remark\" placeholder=\"请输入备注\" />\n\n      <view class=\"footer\">\n        <wd-button type=\"primary\" :loading=\"loading\" block @click=\"handleSubmit\">保存</wd-button>\n      </view>\n    </wd-form>\n  </view>\n</template>\n\n<style lang=\"scss\" scoped>\n.info-page {\n  .footer {\n    padding: 30rpx;\n  }\n}\n</style>\n","import MiniProgramPage from '/Users/jing/Code/mini/vehicle-info/pages/order/devOps/form.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","getConfigDetail","getDictApi","putConfigDetail","postConfigDetail","uni","onLoad"],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAKA,UAAM,UAAUA,cAAG,IAAC,EAAE;AACtB,UAAM,UAAUA,cAAG,IAAC,KAAK;AACzB,UAAM,OAAOA,cAAG,IAAC,IAAI;AACrB,UAAM,QAAQA,cAAAA,IAAI;AAAA,MAChB,2BAA2B;AAAA,MAC3B,4BAA4B;AAAA,MAC5B,QAAQ;AAAA,MACR,2BAA2B;AAAA,IAC7B,CAAC;AACD,UAAM,QAAQA,cAAAA,IAAI;AAAA,MAChB,2BAA2B;AAAA,QACzB,EAAE,UAAU,MAAM,SAAS,UAAW;AAAA,MACvC;AAAA,MACD,4BAA4B;AAAA,QAC1B,EAAE,UAAU,MAAM,SAAS,eAAgB;AAAA,QAC3C,EAAE,KAAK,GAAG,SAAS,iBAAkB;AAAA,QACrC,EAAE,KAAK,KAAK,SAAS,mBAAoB;AAAA,MAC1C;AAAA,IACH,CAAC;AACD,UAAM,YAAY,OAAO,OAAO;AAC9B,YAAM,MAAM,MAAMC,UAAe,gBAAC,EAAE;AACpC,YAAM,QAAQ,IAAI;AAAA,IACpB;AAEA,UAAM,UAAU,OAAO,SAAS;AAC9B,YAAM,MAAM,MAAMC,WAAU,WAAC,IAAI;AACjC,cAAQ,QAAQ,IAAI;AAAA,IACtB;AAEA,UAAM,eAAe,MAAM;AACzB,WAAK,MACF,SAAU,EACV,KAAK,OAAO,EAAE,OAAO,aAAa;AACjC,YAAI,OAAO;AACT,kBAAQ,QAAQ;AAEhB,cAAI;AACJ,cAAI,MAAM,MAAM,2BAA2B;AACzC,kBAAM,MAAMC,UAAAA,gBAAgB,MAAM,KAAK;AAAA,UACjD,OAAe;AACL,kBAAM,MAAMC,UAAAA,iBAAiB,MAAM,KAAK;AAAA,UACzC;AACD,cAAI,IAAI,QAAQ,KAAK;AACnBC,0BAAAA,MAAI,UAAU;AAAA,cACZ,OAAO;AAAA,cACP,MAAM;AAAA,cACN,UAAU;AAAA,cACV,SAAS,MAAM;AACb,2BAAW,MAAM;AACf,0BAAQ,QAAQ;AAChBA,gCAAAA,MAAI,aAAa;AAAA,oBACf,OAAO;AAAA,kBACzB,CAAiB;AAAA,gBACF,GAAE,GAAI;AAAA,cACR;AAAA,YACb,CAAW;AAAA,UACF;AACD,kBAAQ,QAAQ;AAAA,QACjB;AAAA,MACP,CAAK,EACA,MAAM,CAAC,UAAU;AAChBA,sBAAAA,MAAY,MAAA,OAAA,qCAAA,OAAO,OAAO;AAAA,MAChC,CAAK;AAAA,IACL;AAEAC,kBAAM,OAAC,CAAC,UAAU;AAChB,UAAI,MAAM,IAAI;AACZ,kBAAU,MAAM,EAAE;AAAA,MACnB;AACD,cAAQ,iCAAiC;AAAA,IAC3C,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1ED,GAAG,WAAW,eAAe;"}