{"version":3,"file":"mine.js","sources":["pages/mine/mine.vue","pages/mine/mine.vue?type=page"],"sourcesContent":["<script setup>\nimport { ref } from 'vue'\nimport { logoutApi } from '@/api'\nimport { onShow } from '@dcloudio/uni-app'\n\nconst user = ref({})\nconst token = ref('')\nonShow(() => {\n  user.value = uni.getStorageSync('user')\n  token.value = uni.getStorageSync('token')\n})\n\nconst clickEditInfo = () => {\n  uni.navigateTo({\n    url: '/pages/mine/info'\n  })\n}\n\nconst clickToNotice = () => {\n  uni.navigateTo({\n    url: '/pages/mine/notice'\n  })\n}\n\nconst clickToEditPassword = () => {\n  if (!user.value.userName) {\n    uni.showToast({\n      title: '请先登录',\n      icon: 'none'\n    })\n    return\n  }\n  uni.navigateTo({\n    url: '/pages/mine/edit-password'\n  })\n}\n\nconst clickToLogin = () => {\n  uni.navigateTo({\n    url: '/pages/login/login'\n  })\n}\n\nconst logout = () => {\n  uni.showModal({\n    title: '提示',\n    content: '确定退出登录吗？',\n    success: async (res) => {\n      if (res.confirm) {\n        const res = await logoutApi()\n        if (res.code === 200) {\n          uni.showToast({\n            title: '退出登录成功',\n            icon: 'success'\n          })\n          uni.removeStorageSync('token')\n          uni.removeStorageSync('user')\n          uni.removeStorageSync('roles')\n          uni.reLaunch({\n            // url: '/pages/index/index'\n            url: '/pages/login/login'\n          })\n        }\n      }\n    },\n    fail: (err) => {\n      console.log(err, 'err')\n    }\n  })\n}\n</script>\n\n<template>\n  <view class=\"mine-page\">\n    <view class=\"mine__header\">\n      <view class=\"header-con\">\n        <view class=\"error-wrap\" v-if=\"!user.userName\" @click=\"clickToLogin\">登录</view>\n        <view v-else class=\"header-con\">\n          <wd-img class=\"img\" :width=\"80\" :height=\"80\" round :src=\"user.avatar\" />\n          <view class=\"name\" @click=\"clickEditInfo\">{{ user.userName }}</view>\n        </view>\n        <!-- <view class=\"name\" v-else @click=\"clickToLogin\">登录</view> -->\n      </view>\n    </view>\n\n    <view class=\"mine__main\">\n      <wd-grid border clickable hover-class=\" \">\n        <wd-grid-item icon=\"notification\" text=\"系统通知\" is-dot @itemclick=\"clickToNotice\" />\n        <wd-grid-item icon=\"lock-on\" text=\"修改密码\" @itemclick=\"clickToEditPassword\" />\n      </wd-grid>\n    </view>\n\n    <view class=\"mine__footer\" v-if=\"token\">\n      <wd-button type=\"error\" block @click=\"logout\">退出登录</wd-button>\n    </view>\n  </view>\n</template>\n\n<style scoped lang=\"scss\">\n.mine-page {\n\n  .mine__header {\n    height: 400rpx;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    background-color: #eee;\n\n    .header-con {\n      display: flex;\n      flex-direction: column;\n      justify-content: center;\n      align-items: center;\n\n      .error-wrap {\n        width: 80px;\n        height: 80px;\n        background-color: #fff;\n        border: 1rpx solid #000;\n        line-height: 80px;\n        text-align: center;\n        border-radius: 50%;\n      }\n\n      ::v-deep .wd-img {\n        border: 1rpx solid #000;\n      }\n\n      .name {\n        margin-top: 20rpx;\n        font-size: 18px;\n      }\n    }\n  }\n\n  .mine__footer {\n    position: fixed;\n    bottom: 50rpx;\n    left: 40rpx;\n    right: 40rpx;\n    padding: 10rpx 40rpx;\n  }\n}\n</style>\n","import MiniProgramPage from '/Users/jing/Code/mini/vehicle-info/pages/mine/mine.vue'\nwx.createPage(MiniProgramPage)"],"names":["user","ref","token","onShow","uni","clickEditInfo","clickToNotice","clickToEditPassword","clickToLogin","logout","res","logoutApi","err","MiniProgramPage"],"mappings":"moBAKA,MAAMA,EAAOC,EAAG,IAAC,EAAE,EACbC,EAAQD,EAAG,IAAC,EAAE,EACpBE,EAAAA,OAAO,IAAM,CACXH,EAAK,MAAQI,QAAI,eAAe,MAAM,EACtCF,EAAM,MAAQE,QAAI,eAAe,OAAO,CAC1C,CAAC,EAED,MAAMC,EAAgB,IAAM,CAC1BD,EAAAA,MAAI,WAAW,CACb,IAAK,kBACT,CAAG,CACH,EAEME,EAAgB,IAAM,CAC1BF,EAAAA,MAAI,WAAW,CACb,IAAK,oBACT,CAAG,CACH,EAEMG,EAAsB,IAAM,CAChC,GAAI,CAACP,EAAK,MAAM,SAAU,CACxBI,EAAAA,MAAI,UAAU,CACZ,MAAO,OACP,KAAM,MACZ,CAAK,EACD,MACD,CACDA,EAAAA,MAAI,WAAW,CACb,IAAK,2BACT,CAAG,CACH,EAEMI,EAAe,IAAM,CACzBJ,EAAAA,MAAI,WAAW,CACb,IAAK,oBACT,CAAG,CACH,EAEMK,EAAS,IAAM,CACnBL,EAAAA,MAAI,UAAU,CACZ,MAAO,KACP,QAAS,WACT,QAAS,MAAOM,GAAQ,CAClBA,EAAI,UACM,MAAMC,YAAW,GACrB,OAAS,MACfP,EAAAA,MAAI,UAAU,CACZ,MAAO,SACP,KAAM,SAClB,CAAW,EACDA,EAAG,MAAC,kBAAkB,OAAO,EAC7BA,EAAG,MAAC,kBAAkB,MAAM,EAC5BA,EAAG,MAAC,kBAAkB,OAAO,EAC7BA,EAAAA,MAAI,SAAS,CAEX,IAAK,oBACjB,CAAW,EAGN,EACD,KAAOQ,GAAQ,CACbR,EAAAA,8CAAYQ,EAAK,KAAK,CACvB,CACL,CAAG,CACH,sbCpEA,GAAG,WAAWC,CAAe"}