{"version":3,"file":"mine.js","sources":["pages/mine/mine.vue","pages/mine/mine.vue?type=page"],"sourcesContent":["<script setup>\r\nimport { ref } from 'vue'\r\nimport { logoutApi } from '@/api'\r\nimport { onShow } from '@dcloudio/uni-app'\r\n\r\nconst user = ref({})\r\nconst token = ref('')\r\nonShow(() => {\r\n  user.value = uni.getStorageSync('user')\r\n  token.value = uni.getStorageSync('token')\r\n})\r\n\r\nconst clickEditInfo = () => {\r\n  uni.navigateTo({\r\n    url: '/pages/mine/info'\r\n  })\r\n}\r\n\r\nconst clickToNotice = () => {\r\n  uni.navigateTo({\r\n    url: '/pages/mine/notice'\r\n  })\r\n}\r\n\r\nconst clickToEditPassword = () => {\r\n  if (!user.value.userName) {\r\n    uni.showToast({\r\n      title: '请先登录',\r\n      icon: 'none'\r\n    })\r\n    return\r\n  }\r\n  uni.navigateTo({\r\n    url: '/pages/mine/edit-password'\r\n  })\r\n}\r\n\r\nconst clickToLogin = () => {\r\n  uni.navigateTo({\r\n    url: '/pages/login/login'\r\n  })\r\n}\r\n\r\nconst logout = () => {\r\n  uni.showModal({\r\n    title: '提示',\r\n    content: '确定退出登录吗？',\r\n    success: async (res) => {\r\n      if (res.confirm) {\r\n        const res = await logoutApi()\r\n        if (res.code === 200) {\r\n          uni.showToast({\r\n            title: '退出登录成功',\r\n            icon: 'success'\r\n          })\r\n          uni.removeStorageSync('token')\r\n          uni.removeStorageSync('user')\r\n          uni.removeStorageSync('roles')\r\n          uni.reLaunch({\r\n            // url: '/pages/index/index'\r\n            url: '/pages/login/login'\r\n          })\r\n        }\r\n      }\r\n    },\r\n    fail: (err) => {\r\n      console.log(err, 'err')\r\n    }\r\n  })\r\n}\r\n</script>\r\n\r\n<template>\r\n  <view class=\"mine-page\">\r\n    <view class=\"mine__header\">\r\n      <view class=\"header-con\">\r\n        <view class=\"error-wrap\" v-if=\"!user.userName\" @click=\"clickToLogin\">登录</view>\r\n        <view v-else class=\"header-con\">\r\n          <wd-img class=\"img\" :width=\"80\" :height=\"80\" round :src=\"user.avatar\" />\r\n          <view class=\"name\" @click=\"clickEditInfo\">{{ user.userName }}</view>\r\n        </view>\r\n        <!-- <view class=\"name\" v-else @click=\"clickToLogin\">登录</view> -->\r\n      </view>\r\n    </view>\r\n\r\n    <view class=\"mine__main\">\r\n      <wd-grid border clickable hover-class=\" \">\r\n        <wd-grid-item icon=\"notification\" text=\"系统通知\" is-dot @itemclick=\"clickToNotice\" />\r\n        <wd-grid-item icon=\"lock-on\" text=\"修改密码\" @itemclick=\"clickToEditPassword\" />\r\n      </wd-grid>\r\n    </view>\r\n\r\n    <view class=\"mine__footer\" v-if=\"token\">\r\n      <wd-button type=\"error\" block @click=\"logout\">退出登录</wd-button>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<style scoped lang=\"scss\">\r\n.mine-page {\r\n\r\n  .mine__header {\r\n    height: 400rpx;\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    background-color: #eee;\r\n\r\n    .header-con {\r\n      display: flex;\r\n      flex-direction: column;\r\n      justify-content: center;\r\n      align-items: center;\r\n\r\n      .error-wrap {\r\n        width: 80px;\r\n        height: 80px;\r\n        background-color: #fff;\r\n        border: 1rpx solid #000;\r\n        line-height: 80px;\r\n        text-align: center;\r\n        border-radius: 50%;\r\n      }\r\n\r\n      ::v-deep .wd-img {\r\n        border: 1rpx solid #000;\r\n      }\r\n\r\n      .name {\r\n        margin-top: 20rpx;\r\n        font-size: 18px;\r\n      }\r\n    }\r\n  }\r\n\r\n  .mine__footer {\r\n    position: fixed;\r\n    bottom: 50rpx;\r\n    left: 40rpx;\r\n    right: 40rpx;\r\n    padding: 10rpx 40rpx;\r\n  }\r\n}\r\n</style>\r\n","import MiniProgramPage from '/Users/jing/Code/mini/vehicle-info/pages/mine/mine.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","onShow","uni","res","logoutApi"],"mappings":";;;;;;;;;;;;;;;;;;;;;AAKA,UAAM,OAAOA,cAAG,IAAC,EAAE;AACnB,UAAM,QAAQA,cAAG,IAAC,EAAE;AACpBC,kBAAAA,OAAO,MAAM;AACX,WAAK,QAAQC,oBAAI,eAAe,MAAM;AACtC,YAAM,QAAQA,oBAAI,eAAe,OAAO;AAAA,IAC1C,CAAC;AAED,UAAM,gBAAgB,MAAM;AAC1BA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK;AAAA,MACT,CAAG;AAAA,IACH;AAEA,UAAM,gBAAgB,MAAM;AAC1BA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK;AAAA,MACT,CAAG;AAAA,IACH;AAEA,UAAM,sBAAsB,MAAM;AAChC,UAAI,CAAC,KAAK,MAAM,UAAU;AACxBA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QACZ,CAAK;AACD;AAAA,MACD;AACDA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK;AAAA,MACT,CAAG;AAAA,IACH;AAEA,UAAM,eAAe,MAAM;AACzBA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK;AAAA,MACT,CAAG;AAAA,IACH;AAEA,UAAM,SAAS,MAAM;AACnBA,oBAAAA,MAAI,UAAU;AAAA,QACZ,OAAO;AAAA,QACP,SAAS;AAAA,QACT,SAAS,OAAO,QAAQ;AACtB,cAAI,IAAI,SAAS;AACf,kBAAMC,OAAM,MAAMC,qBAAW;AAC7B,gBAAID,KAAI,SAAS,KAAK;AACpBD,4BAAAA,MAAI,UAAU;AAAA,gBACZ,OAAO;AAAA,gBACP,MAAM;AAAA,cAClB,CAAW;AACDA,4BAAG,MAAC,kBAAkB,OAAO;AAC7BA,4BAAG,MAAC,kBAAkB,MAAM;AAC5BA,4BAAG,MAAC,kBAAkB,OAAO;AAC7BA,4BAAAA,MAAI,SAAS;AAAA;AAAA,gBAEX,KAAK;AAAA,cACjB,CAAW;AAAA,YACF;AAAA,UACF;AAAA,QACF;AAAA,QACD,MAAM,CAAC,QAAQ;AACbA,wBAAAA,gDAAY,KAAK,KAAK;AAAA,QACvB;AAAA,MACL,CAAG;AAAA,IACH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACpEA,GAAG,WAAW,eAAe;"}