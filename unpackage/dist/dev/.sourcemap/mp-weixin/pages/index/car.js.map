{"version":3,"file":"car.js","sources":["pages/index/car.vue","pages/index/car.vue?type=page"],"sourcesContent":["<script setup>\nimport { onLoad, onReachBottom } from '@dcloudio/uni-app'\nimport { reactive, ref } from 'vue'\nimport { getCarListApi } from '@/api'\n\nconst list = ref([])\nconst total = ref(0)\nconst queryParams = reactive({\n  pageNum: 1,\n  pageSize: 10,\n  order: 'asc',\n  plateNumber: ''\n})\nconst loading = ref(false)\nconst state = ref('loading')\n\nonReachBottom(() => {\n  if (list.value.length === total.value) {\n    state.value = 'finished'\n  } else if (!list.value.length) {\n    state.value = 'error'\n  } else if (list.value.length < total.value) {\n    loadmore()\n  }\n})\n\nonLoad(() => {\n  getData()\n})\n\nfunction loadmore() {\n  queryParams.pageNum++\n  state.value = 'loading'\n  getData()\n}\n\nconst getData = async () => {\n  loading.value = true\n  const res = await getCarListApi(queryParams)\n  list.value = [...list.value, ...res.rows]\n  total.value = res.total\n  loading.value = false\n\n  if (list.value.length === total.value) {\n    state.value = 'finished'\n  } else if (!list.value.length) {\n    state.value = 'error'\n  }\n}\nconst search = ({ value }) => {\n  queryParams.plateNumber = value\n  queryParams.pageNum = 1\n  list.value = []\n  total.value = 0\n  state.value = 'loading'\n  getData()\n}\nconst clear = () => {\n  state.value = 'loading'\n  queryParams.plateNumber = ''\n  queryParams.pageNum = 1\n  queryParams.order = 'asc'\n  list.value = []\n  total.value = 0\n  getData()\n}\nconst cancel = () => {\n  clear()\n}\n\nconst clickToLocal = (i) => {\n  uni.navigateTo({\n    url: '/pages/index/localMap?plateNumber=' + i.plateNumber\n  })\n}\n</script>\n\n<template>\n  <view class=\"driver-page\">\n    <wd-sticky>\n      <view style=\"width: 100vw;\">\n        <wd-search placeholder-left placeholder=\"请输入车牌号码搜索\" v-model=\"queryParams.plateNumber\" @search=\"search\"\n          @clear=\"clear\" @cancel=\"cancel\" :maxlength=\"10\" />\n      </view>\n    </wd-sticky>\n    <BaseLoading :loading=\"loading\" v-if=\"loading && !list.length\" />\n    <view class=\"container\" v-else>\n      <view v-for=\"i in list\" :key=\"i.driverId\">\n        <wd-card>\n          <template #title>\n            <view style=\"display: flex; text-align: right;\">\n              <view class=\"flex-col-c\">\n                <view class=\"name\">{{ i.plateNumber }}</view>\n                <view class=\"sex\">\n                  <wd-tag type=\"primary\" v-if=\"i.brandModel\">{{ i.brandModel }}</wd-tag>\n                </view>\n              </view>\n              <view class=\"right\">\n                <wd-tag type=\"success\" mark v-if=\"i.vehicleStatusName\">{{ i.vehicleStatusName }}</wd-tag>\n              </view>\n            </view>\n          </template>\n          <view style=\"display: flex; justify-content: space-between; align-items: flex-end;\">\n            <view class=\"content\">\n              <view style=\"display: flex; justify-content: space-between;\">\n                <!-- <view class=\"content-item\">\n                  <view class=\"label\">准驾车型：</view>\n                  <view class=\"value\">A1</view>\n                </view> -->\n                <view class=\"content-item\" v-if=\"i.driverName\">\n                  <view class=\"label\">车辆司机：</view>\n                  <view class=\"value\">{{ i.driverName }}</view>\n                </view>\n              </view>\n              <view class=\"content-item\">\n                <view class=\"label\">部门名称：</view>\n                <view class=\"value\">{{ i.deptName }} {{ `(${i.cityName}${i.countyName || ''})` }}</view>\n              </view>\n              <view class=\"content-item\">\n                <view class=\"label\">车辆用途：</view>\n                <view class=\"value\">{{ i.vehicleApplicationNames }}</view>\n              </view>\n              <view class=\"content-item\">\n                <view class=\"label\">初次上线时间：</view>\n                <view class=\"value\">{{ i.terminalFirstOnlineTime }}</view>\n              </view>\n              <view class=\"content-item pd\">\n                <view class=\"label\">最近离线时间：</view>\n                <view class=\"value\">{{ i.terminalRecentOfflineTime }}</view>\n              </view>\n            </view>\n\n            <image @click=\"clickToLocal(i)\" class=\"img-local\" :src=\"'/static/local.png'\" mode=\"\"></image>\n\n          </view>\n        </wd-card>\n\n      </view>\n      <wd-loadmore :state=\"state\" @reload=\"loadmore\" />\n    </view>\n\n    <wd-status-tip v-if=\"!loading && total == 0\" image=\"/static/content.png\" tip=\"暂无列表\" />\n  </view>\n</template>\n\n<style lang=\"scss\" scoped>\n.driver-page {\n  ::v-deep .wd-card__title-content {\n    padding: 20rpx 0;\n  }\n\n  .container {\n    .name {\n      color: #597fe8;\n    }\n\n    .sex {\n      margin-left: 12rpx;\n    }\n\n    .content {\n      .content-item {\n        display: flex;\n        margin-bottom: 6rpx;\n\n        .value {\n          color: #333;\n        }\n      }\n    }\n\n    .pd {\n      padding-bottom: 12rpx;\n    }\n\n    .img-local {\n      width: 54rpx;\n      height: 54rpx;\n      margin-bottom: 20rpx;\n      margin-right: 20rpx;\n    }\n  }\n}\n\n\nimage {\n  display: block;\n  width: 120px;\n  height: 78px;\n  margin-right: 15px;\n}\n\n.right {\n  -webkit-box-flex: 1;\n  -ms-flex: 1;\n  flex: 1;\n}\n</style>\n","import MiniProgramPage from '/Users/jing/Code/mini/vehicle-info/pages/index/car.vue'\nwx.createPage(MiniProgramPage)"],"names":["list","ref","total","queryParams","reactive","loading","state","onReachBottom","loadmore","onLoad","getData","res","getCarListApi","search","value","clear","cancel","clickToLocal","i","uni","MiniProgramPage"],"mappings":"q7BAKA,MAAMA,EAAOC,EAAG,IAAC,EAAE,EACbC,EAAQD,EAAG,IAAC,CAAC,EACbE,EAAcC,EAAAA,SAAS,CAC3B,QAAS,EACT,SAAU,GACV,MAAO,MACP,YAAa,EACf,CAAC,EACKC,EAAUJ,EAAG,IAAC,EAAK,EACnBK,EAAQL,EAAG,IAAC,SAAS,EAE3BM,EAAAA,cAAc,IAAM,CACdP,EAAK,MAAM,SAAWE,EAAM,MAC9BI,EAAM,MAAQ,WACJN,EAAK,MAAM,OAEZA,EAAK,MAAM,OAASE,EAAM,OACnCM,EAAU,EAFVF,EAAM,MAAQ,OAIlB,CAAC,EAEDG,EAAAA,OAAO,IAAM,CACXC,EAAS,CACX,CAAC,EAED,SAASF,GAAW,CAClBL,EAAY,UACZG,EAAM,MAAQ,UACdI,EAAS,CACX,CAEA,MAAMA,EAAU,SAAY,CAC1BL,EAAQ,MAAQ,GAChB,MAAMM,EAAM,MAAMC,EAAa,cAACT,CAAW,EAC3CH,EAAK,MAAQ,CAAC,GAAGA,EAAK,MAAO,GAAGW,EAAI,IAAI,EACxCT,EAAM,MAAQS,EAAI,MAClBN,EAAQ,MAAQ,GAEZL,EAAK,MAAM,SAAWE,EAAM,MAC9BI,EAAM,MAAQ,WACJN,EAAK,MAAM,SACrBM,EAAM,MAAQ,QAElB,EACMO,EAAS,CAAC,CAAE,MAAAC,KAAY,CAC5BX,EAAY,YAAcW,EAC1BX,EAAY,QAAU,EACtBH,EAAK,MAAQ,CAAE,EACfE,EAAM,MAAQ,EACdI,EAAM,MAAQ,UACdI,EAAS,CACX,EACMK,EAAQ,IAAM,CAClBT,EAAM,MAAQ,UACdH,EAAY,YAAc,GAC1BA,EAAY,QAAU,EACtBA,EAAY,MAAQ,MACpBH,EAAK,MAAQ,CAAE,EACfE,EAAM,MAAQ,EACdQ,EAAS,CACX,EACMM,EAAS,IAAM,CACnBD,EAAO,CACT,EAEME,EAAgBC,GAAM,CAC1BC,EAAAA,MAAI,WAAW,CACb,IAAK,qCAAuCD,EAAE,WAClD,CAAG,CACH,qgCCzEA,GAAG,WAAWE,CAAe"}