{"version":3,"file":"rng.js","sources":["uni_modules/jsencrypt/lib/lib/jsbn/rng.js"],"sourcesContent":["// Random number generator - requires a PRNG backend, e.g. prng4.js\nimport { prng_newstate, rng_psize } from \"./prng4\";\nvar rng_state;\nvar rng_pool = null;\nvar rng_pptr;\n// Initialize the pool with junk if needed.\nif (rng_pool == null) {\n    rng_pool = [];\n    rng_pptr = 0;\n    var t = void 0;\n    if (typeof window !== 'undefined' && window.crypto && window.crypto.getRandomValues) {\n        // Extract entropy (2048 bits) from RNG if available\n        var z = new Uint32Array(256);\n        window.crypto.getRandomValues(z);\n        for (t = 0; t < z.length; ++t) {\n            rng_pool[rng_pptr++] = z[t] & 255;\n        }\n    }\n    // Use mouse events for entropy, if we do not have enough entropy by the time\n    // we need it, entropy will be generated by Math.random.\n    var count = 0;\n    var onMouseMoveListener_1 = function (ev) {\n        count = count || 0;\n        if (count >= 256 || rng_pptr >= rng_psize) {\n            if (window.removeEventListener) {\n                window.removeEventListener(\"mousemove\", onMouseMoveListener_1, false);\n            }\n            else if (window.detachEvent) {\n                window.detachEvent(\"onmousemove\", onMouseMoveListener_1);\n            }\n            return;\n        }\n        try {\n            var mouseCoordinates = ev.x + ev.y;\n            rng_pool[rng_pptr++] = mouseCoordinates & 255;\n            count += 1;\n        }\n        catch (e) {\n            // Sometimes Firefox will deny permission to access event properties for some reason. Ignore.\n        }\n    };\n    if (typeof window !== 'undefined') {\n        if (window.addEventListener) {\n            window.addEventListener(\"mousemove\", onMouseMoveListener_1, false);\n        }\n        else if (window.attachEvent) {\n            window.attachEvent(\"onmousemove\", onMouseMoveListener_1);\n        }\n    }\n}\nfunction rng_get_byte() {\n    if (rng_state == null) {\n        rng_state = prng_newstate();\n        // At this point, we may not have collected enough entropy.  If not, fall back to Math.random\n        while (rng_pptr < rng_psize) {\n            var random = Math.floor(65536 * Math.random());\n            rng_pool[rng_pptr++] = random & 255;\n        }\n        rng_state.init(rng_pool);\n        for (rng_pptr = 0; rng_pptr < rng_pool.length; ++rng_pptr) {\n            rng_pool[rng_pptr] = 0;\n        }\n        rng_pptr = 0;\n    }\n    // TODO: allow reseeding after first request\n    return rng_state.next();\n}\nvar SecureRandom = /** @class */ (function () {\n    function SecureRandom() {\n    }\n    SecureRandom.prototype.nextBytes = function (ba) {\n        for (var i = 0; i < ba.length; ++i) {\n            ba[i] = rng_get_byte();\n        }\n    };\n    return SecureRandom;\n}());\nexport { SecureRandom };\n"],"names":["rng_state","rng_pool","rng_pptr","t","z","count","onMouseMoveListener_1","ev","rng_psize","mouseCoordinates","rng_get_byte","prng_newstate","random","SecureRandom","ba","i"],"mappings":"2CAEA,IAAIA,EACAC,EAAW,KACXC,EAEJ,GAAID,GAAY,KAAM,CAClBA,EAAW,CAAA,EACXC,EAAW,EACX,IAAIC,EAAI,OACR,GAAI,OAAO,OAAW,KAAe,OAAO,QAAU,OAAO,OAAO,gBAAiB,CAEjF,IAAIC,EAAI,IAAI,YAAY,GAAG,EAE3B,IADA,OAAO,OAAO,gBAAgBA,CAAC,EAC1BD,EAAI,EAAGA,EAAIC,EAAE,OAAQ,EAAED,EACxBF,EAASC,GAAU,EAAIE,EAAED,CAAC,EAAI,GAErC,CAGD,IAAIE,EAAQ,EACRC,EAAwB,SAAUC,EAAI,CAEtC,GADAF,EAAQA,GAAS,EACbA,GAAS,KAAOH,GAAYM,YAAW,CACnC,OAAO,oBACP,OAAO,oBAAoB,YAAaF,EAAuB,EAAK,EAE/D,OAAO,aACZ,OAAO,YAAY,cAAeA,CAAqB,EAE3D,MACH,CACD,GAAI,CACA,IAAIG,EAAmBF,EAAG,EAAIA,EAAG,EACjCN,EAASC,GAAU,EAAIO,EAAmB,IAC1CJ,GAAS,CACZ,MACS,CAET,CACT,EACQ,OAAO,OAAW,MACd,OAAO,iBACP,OAAO,iBAAiB,YAAaC,EAAuB,EAAK,EAE5D,OAAO,aACZ,OAAO,YAAY,cAAeA,CAAqB,EAGnE,CACA,SAASI,GAAe,CACpB,GAAIV,GAAa,KAAM,CAGnB,IAFAA,EAAYW,EAAa,cAAA,EAElBT,EAAWM,EAAAA,WAAW,CACzB,IAAII,EAAS,KAAK,MAAM,MAAQ,KAAK,OAAM,CAAE,EAC7CX,EAASC,GAAU,EAAIU,EAAS,GACnC,CAED,IADAZ,EAAU,KAAKC,CAAQ,EAClBC,EAAW,EAAGA,EAAWD,EAAS,OAAQ,EAAEC,EAC7CD,EAASC,CAAQ,EAAI,EAEzBA,EAAW,CACd,CAED,OAAOF,EAAU,MACrB,CACG,IAACa,EAA8B,UAAY,CAC1C,SAASA,GAAe,CACvB,CACD,OAAAA,EAAa,UAAU,UAAY,SAAUC,EAAI,CAC7C,QAASC,EAAI,EAAGA,EAAID,EAAG,OAAQ,EAAEC,EAC7BD,EAAGC,CAAC,EAAIL,GAEpB,EACWG,CACX,EAAG"}