{"version":3,"file":"rng.js","sources":["uni_modules/jsencrypt/lib/lib/jsbn/rng.js"],"sourcesContent":["// Random number generator - requires a PRNG backend, e.g. prng4.js\nimport { prng_newstate, rng_psize } from \"./prng4\";\nvar rng_state;\nvar rng_pool = null;\nvar rng_pptr;\n// Initialize the pool with junk if needed.\nif (rng_pool == null) {\n    rng_pool = [];\n    rng_pptr = 0;\n    var t = void 0;\n    if (typeof window !== 'undefined' && window.crypto && window.crypto.getRandomValues) {\n        // Extract entropy (2048 bits) from RNG if available\n        var z = new Uint32Array(256);\n        window.crypto.getRandomValues(z);\n        for (t = 0; t < z.length; ++t) {\n            rng_pool[rng_pptr++] = z[t] & 255;\n        }\n    }\n    // Use mouse events for entropy, if we do not have enough entropy by the time\n    // we need it, entropy will be generated by Math.random.\n    var count = 0;\n    var onMouseMoveListener_1 = function (ev) {\n        count = count || 0;\n        if (count >= 256 || rng_pptr >= rng_psize) {\n            if (window.removeEventListener) {\n                window.removeEventListener(\"mousemove\", onMouseMoveListener_1, false);\n            }\n            else if (window.detachEvent) {\n                window.detachEvent(\"onmousemove\", onMouseMoveListener_1);\n            }\n            return;\n        }\n        try {\n            var mouseCoordinates = ev.x + ev.y;\n            rng_pool[rng_pptr++] = mouseCoordinates & 255;\n            count += 1;\n        }\n        catch (e) {\n            // Sometimes Firefox will deny permission to access event properties for some reason. Ignore.\n        }\n    };\n    if (typeof window !== 'undefined') {\n        if (window.addEventListener) {\n            window.addEventListener(\"mousemove\", onMouseMoveListener_1, false);\n        }\n        else if (window.attachEvent) {\n            window.attachEvent(\"onmousemove\", onMouseMoveListener_1);\n        }\n    }\n}\nfunction rng_get_byte() {\n    if (rng_state == null) {\n        rng_state = prng_newstate();\n        // At this point, we may not have collected enough entropy.  If not, fall back to Math.random\n        while (rng_pptr < rng_psize) {\n            var random = Math.floor(65536 * Math.random());\n            rng_pool[rng_pptr++] = random & 255;\n        }\n        rng_state.init(rng_pool);\n        for (rng_pptr = 0; rng_pptr < rng_pool.length; ++rng_pptr) {\n            rng_pool[rng_pptr] = 0;\n        }\n        rng_pptr = 0;\n    }\n    // TODO: allow reseeding after first request\n    return rng_state.next();\n}\nvar SecureRandom = /** @class */ (function () {\n    function SecureRandom() {\n    }\n    SecureRandom.prototype.nextBytes = function (ba) {\n        for (var i = 0; i < ba.length; ++i) {\n            ba[i] = rng_get_byte();\n        }\n    };\n    return SecureRandom;\n}());\nexport { SecureRandom };\n"],"names":["rng_psize","prng_newstate","SecureRandom"],"mappings":";;AAEA,IAAI;AACJ,IAAI,WAAW;AACf,IAAI;AAEJ,IAAI,YAAY,MAAM;AAClB,aAAW,CAAA;AACX,aAAW;AACX,MAAI,IAAI;AACR,MAAI,OAAO,WAAW,eAAe,OAAO,UAAU,OAAO,OAAO,iBAAiB;AAEjF,QAAI,IAAI,IAAI,YAAY,GAAG;AAC3B,WAAO,OAAO,gBAAgB,CAAC;AAC/B,SAAK,IAAI,GAAG,IAAI,EAAE,QAAQ,EAAE,GAAG;AAC3B,eAAS,UAAU,IAAI,EAAE,CAAC,IAAI;AAAA,IACjC;AAAA,EACJ;AAGD,MAAI,QAAQ;AACZ,MAAI,wBAAwB,SAAU,IAAI;AACtC,YAAQ,SAAS;AACjB,QAAI,SAAS,OAAO,YAAYA,oDAAW;AACvC,UAAI,OAAO,qBAAqB;AAC5B,eAAO,oBAAoB,aAAa,uBAAuB,KAAK;AAAA,MACvE,WACQ,OAAO,aAAa;AACzB,eAAO,YAAY,eAAe,qBAAqB;AAAA,MAC1D;AACD;AAAA,IACH;AACD,QAAI;AACA,UAAI,mBAAmB,GAAG,IAAI,GAAG;AACjC,eAAS,UAAU,IAAI,mBAAmB;AAC1C,eAAS;AAAA,IACZ,SACM,GAAG;AAAA,IAET;AAAA,EACT;AACI,MAAI,OAAO,WAAW,aAAa;AAC/B,QAAI,OAAO,kBAAkB;AACzB,aAAO,iBAAiB,aAAa,uBAAuB,KAAK;AAAA,IACpE,WACQ,OAAO,aAAa;AACzB,aAAO,YAAY,eAAe,qBAAqB;AAAA,IAC1D;AAAA,EACJ;AACL;AACA,SAAS,eAAe;AACpB,MAAI,aAAa,MAAM;AACnB,gBAAYC,yCAAa,cAAA;AAEzB,WAAO,WAAWD,yCAAAA,WAAW;AACzB,UAAI,SAAS,KAAK,MAAM,QAAQ,KAAK,OAAM,CAAE;AAC7C,eAAS,UAAU,IAAI,SAAS;AAAA,IACnC;AACD,cAAU,KAAK,QAAQ;AACvB,SAAK,WAAW,GAAG,WAAW,SAAS,QAAQ,EAAE,UAAU;AACvD,eAAS,QAAQ,IAAI;AAAA,IACxB;AACD,eAAW;AAAA,EACd;AAED,SAAO,UAAU;AACrB;AACG,IAAC;AAAA;AAAA,EAA8B,WAAY;AAC1C,aAASE,gBAAe;AAAA,IACvB;AACD,IAAAA,cAAa,UAAU,YAAY,SAAU,IAAI;AAC7C,eAAS,IAAI,GAAG,IAAI,GAAG,QAAQ,EAAE,GAAG;AAChC,WAAG,CAAC,IAAI;MACX;AAAA,IACT;AACI,WAAOA;AAAA,EACX,EAAG;AAAA;;"}