{"version":3,"file":"rsa.js","sources":["uni_modules/jsencrypt/lib/lib/jsbn/rsa.js"],"sourcesContent":["// Depends on jsbn.js and rng.js\n// Version 1.1: support utf-8 encoding in pkcs1pad2\n// convert a (hex) string to a bignum object\nimport { BigInteger, nbi, parseBigInt } from \"./jsbn\";\nimport { SecureRandom } from \"./rng\";\n// function linebrk(s,n) {\n//   var ret = \"\";\n//   var i = 0;\n//   while(i + n < s.length) {\n//     ret += s.substring(i,i+n) + \"\\n\";\n//     i += n;\n//   }\n//   return ret + s.substring(i,s.length);\n// }\n// function byte2Hex(b) {\n//   if(b < 0x10)\n//     return \"0\" + b.toString(16);\n//   else\n//     return b.toString(16);\n// }\nfunction pkcs1pad1(s, n) {\n    if (n < s.length + 22) {\n        console.error(\"Message too long for RSA\");\n        return null;\n    }\n    var len = n - s.length - 6;\n    var filler = \"\";\n    for (var f = 0; f < len; f += 2) {\n        filler += \"ff\";\n    }\n    var m = \"0001\" + filler + \"00\" + s;\n    return parseBigInt(m, 16);\n}\n// PKCS#1 (type 2, random) pad input string s to n bytes, and return a bigint\nfunction pkcs1pad2(s, n) {\n    if (n < s.length + 11) { // TODO: fix for utf-8\n        console.error(\"Message too long for RSA\");\n        return null;\n    }\n    var ba = [];\n    var i = s.length - 1;\n    while (i >= 0 && n > 0) {\n        var c = s.charCodeAt(i--);\n        if (c < 128) { // encode using utf-8\n            ba[--n] = c;\n        }\n        else if ((c > 127) && (c < 2048)) {\n            ba[--n] = (c & 63) | 128;\n            ba[--n] = (c >> 6) | 192;\n        }\n        else {\n            ba[--n] = (c & 63) | 128;\n            ba[--n] = ((c >> 6) & 63) | 128;\n            ba[--n] = (c >> 12) | 224;\n        }\n    }\n    ba[--n] = 0;\n    var rng = new SecureRandom();\n    var x = [];\n    while (n > 2) { // random non-zero pad\n        x[0] = 0;\n        while (x[0] == 0) {\n            rng.nextBytes(x);\n        }\n        ba[--n] = x[0];\n    }\n    ba[--n] = 2;\n    ba[--n] = 0;\n    return new BigInteger(ba);\n}\n// \"empty\" RSA key constructor\nvar RSAKey = /** @class */ (function () {\n    function RSAKey() {\n        this.n = null;\n        this.e = 0;\n        this.d = null;\n        this.p = null;\n        this.q = null;\n        this.dmp1 = null;\n        this.dmq1 = null;\n        this.coeff = null;\n    }\n    //#region PROTECTED\n    // protected\n    // RSAKey.prototype.doPublic = RSADoPublic;\n    // Perform raw public operation on \"x\": return x^e (mod n)\n    RSAKey.prototype.doPublic = function (x) {\n        return x.modPowInt(this.e, this.n);\n    };\n    // RSAKey.prototype.doPrivate = RSADoPrivate;\n    // Perform raw private operation on \"x\": return x^d (mod n)\n    RSAKey.prototype.doPrivate = function (x) {\n        if (this.p == null || this.q == null) {\n            return x.modPow(this.d, this.n);\n        }\n        // TODO: re-calculate any missing CRT params\n        var xp = x.mod(this.p).modPow(this.dmp1, this.p);\n        var xq = x.mod(this.q).modPow(this.dmq1, this.q);\n        while (xp.compareTo(xq) < 0) {\n            xp = xp.add(this.p);\n        }\n        return xp.subtract(xq).multiply(this.coeff).mod(this.p).multiply(this.q).add(xq);\n    };\n    //#endregion PROTECTED\n    //#region PUBLIC\n    // RSAKey.prototype.setPublic = RSASetPublic;\n    // Set the public key fields N and e from hex strings\n    RSAKey.prototype.setPublic = function (N, E) {\n        if (N != null && E != null && N.length > 0 && E.length > 0) {\n            this.n = parseBigInt(N, 16);\n            this.e = parseInt(E, 16);\n        }\n        else {\n            console.error(\"Invalid RSA public key\");\n        }\n    };\n    // RSAKey.prototype.encrypt = RSAEncrypt;\n    // Return the PKCS#1 RSA encryption of \"text\" as an even-length hex string\n    RSAKey.prototype.encrypt = function (text) {\n        var maxLength = (this.n.bitLength() + 7) >> 3;\n        var m = pkcs1pad2(text, maxLength);\n        if (m == null) {\n            return null;\n        }\n        var c = this.doPublic(m);\n        if (c == null) {\n            return null;\n        }\n        var h = c.toString(16);\n        var length = h.length;\n        // fix zero before result\n        for (var i = 0; i < maxLength * 2 - length; i++) {\n            h = \"0\" + h;\n        }\n        return h;\n    };\n    // RSAKey.prototype.setPrivate = RSASetPrivate;\n    // Set the private key fields N, e, and d from hex strings\n    RSAKey.prototype.setPrivate = function (N, E, D) {\n        if (N != null && E != null && N.length > 0 && E.length > 0) {\n            this.n = parseBigInt(N, 16);\n            this.e = parseInt(E, 16);\n            this.d = parseBigInt(D, 16);\n        }\n        else {\n            console.error(\"Invalid RSA private key\");\n        }\n    };\n    // RSAKey.prototype.setPrivateEx = RSASetPrivateEx;\n    // Set the private key fields N, e, d and CRT params from hex strings\n    RSAKey.prototype.setPrivateEx = function (N, E, D, P, Q, DP, DQ, C) {\n        if (N != null && E != null && N.length > 0 && E.length > 0) {\n            this.n = parseBigInt(N, 16);\n            this.e = parseInt(E, 16);\n            this.d = parseBigInt(D, 16);\n            this.p = parseBigInt(P, 16);\n            this.q = parseBigInt(Q, 16);\n            this.dmp1 = parseBigInt(DP, 16);\n            this.dmq1 = parseBigInt(DQ, 16);\n            this.coeff = parseBigInt(C, 16);\n        }\n        else {\n            console.error(\"Invalid RSA private key\");\n        }\n    };\n    // RSAKey.prototype.generate = RSAGenerate;\n    // Generate a new random private key B bits long, using public expt E\n    RSAKey.prototype.generate = function (B, E) {\n        var rng = new SecureRandom();\n        var qs = B >> 1;\n        this.e = parseInt(E, 16);\n        var ee = new BigInteger(E, 16);\n        for (;;) {\n            for (;;) {\n                this.p = new BigInteger(B - qs, 1, rng);\n                if (this.p.subtract(BigInteger.ONE).gcd(ee).compareTo(BigInteger.ONE) == 0 && this.p.isProbablePrime(10)) {\n                    break;\n                }\n            }\n            for (;;) {\n                this.q = new BigInteger(qs, 1, rng);\n                if (this.q.subtract(BigInteger.ONE).gcd(ee).compareTo(BigInteger.ONE) == 0 && this.q.isProbablePrime(10)) {\n                    break;\n                }\n            }\n            if (this.p.compareTo(this.q) <= 0) {\n                var t = this.p;\n                this.p = this.q;\n                this.q = t;\n            }\n            var p1 = this.p.subtract(BigInteger.ONE);\n            var q1 = this.q.subtract(BigInteger.ONE);\n            var phi = p1.multiply(q1);\n            if (phi.gcd(ee).compareTo(BigInteger.ONE) == 0) {\n                this.n = this.p.multiply(this.q);\n                this.d = ee.modInverse(phi);\n                this.dmp1 = this.d.mod(p1);\n                this.dmq1 = this.d.mod(q1);\n                this.coeff = this.q.modInverse(this.p);\n                break;\n            }\n        }\n    };\n    // RSAKey.prototype.decrypt = RSADecrypt;\n    // Return the PKCS#1 RSA decryption of \"ctext\".\n    // \"ctext\" is an even-length hex string and the output is a plain string.\n    RSAKey.prototype.decrypt = function (ctext) {\n        var c = parseBigInt(ctext, 16);\n        var m = this.doPrivate(c);\n        if (m == null) {\n            return null;\n        }\n        return pkcs1unpad2(m, (this.n.bitLength() + 7) >> 3);\n    };\n    // Generate a new random private key B bits long, using public expt E\n    RSAKey.prototype.generateAsync = function (B, E, callback) {\n        var rng = new SecureRandom();\n        var qs = B >> 1;\n        this.e = parseInt(E, 16);\n        var ee = new BigInteger(E, 16);\n        var rsa = this;\n        // These functions have non-descript names because they were originally for(;;) loops.\n        // I don't know about cryptography to give them better names than loop1-4.\n        var loop1 = function () {\n            var loop4 = function () {\n                if (rsa.p.compareTo(rsa.q) <= 0) {\n                    var t = rsa.p;\n                    rsa.p = rsa.q;\n                    rsa.q = t;\n                }\n                var p1 = rsa.p.subtract(BigInteger.ONE);\n                var q1 = rsa.q.subtract(BigInteger.ONE);\n                var phi = p1.multiply(q1);\n                if (phi.gcd(ee).compareTo(BigInteger.ONE) == 0) {\n                    rsa.n = rsa.p.multiply(rsa.q);\n                    rsa.d = ee.modInverse(phi);\n                    rsa.dmp1 = rsa.d.mod(p1);\n                    rsa.dmq1 = rsa.d.mod(q1);\n                    rsa.coeff = rsa.q.modInverse(rsa.p);\n                    setTimeout(function () { callback(); }, 0); // escape\n                }\n                else {\n                    setTimeout(loop1, 0);\n                }\n            };\n            var loop3 = function () {\n                rsa.q = nbi();\n                rsa.q.fromNumberAsync(qs, 1, rng, function () {\n                    rsa.q.subtract(BigInteger.ONE).gcda(ee, function (r) {\n                        if (r.compareTo(BigInteger.ONE) == 0 && rsa.q.isProbablePrime(10)) {\n                            setTimeout(loop4, 0);\n                        }\n                        else {\n                            setTimeout(loop3, 0);\n                        }\n                    });\n                });\n            };\n            var loop2 = function () {\n                rsa.p = nbi();\n                rsa.p.fromNumberAsync(B - qs, 1, rng, function () {\n                    rsa.p.subtract(BigInteger.ONE).gcda(ee, function (r) {\n                        if (r.compareTo(BigInteger.ONE) == 0 && rsa.p.isProbablePrime(10)) {\n                            setTimeout(loop3, 0);\n                        }\n                        else {\n                            setTimeout(loop2, 0);\n                        }\n                    });\n                });\n            };\n            setTimeout(loop2, 0);\n        };\n        setTimeout(loop1, 0);\n    };\n    RSAKey.prototype.sign = function (text, digestMethod, digestName) {\n        var header = getDigestHeader(digestName);\n        var digest = header + digestMethod(text).toString();\n        var m = pkcs1pad1(digest, this.n.bitLength() / 4);\n        if (m == null) {\n            return null;\n        }\n        var c = this.doPrivate(m);\n        if (c == null) {\n            return null;\n        }\n        var h = c.toString(16);\n        if ((h.length & 1) == 0) {\n            return h;\n        }\n        else {\n            return \"0\" + h;\n        }\n    };\n    RSAKey.prototype.verify = function (text, signature, digestMethod) {\n        var c = parseBigInt(signature, 16);\n        var m = this.doPublic(c);\n        if (m == null) {\n            return null;\n        }\n        var unpadded = m.toString(16).replace(/^1f+00/, \"\");\n        var digest = removeDigestHeader(unpadded);\n        return digest == digestMethod(text).toString();\n    };\n    return RSAKey;\n}());\nexport { RSAKey };\n// Undo PKCS#1 (type 2, random) padding and, if valid, return the plaintext\nfunction pkcs1unpad2(d, n) {\n    var b = d.toByteArray();\n    var i = 0;\n    while (i < b.length && b[i] == 0) {\n        ++i;\n    }\n    if (b.length - i != n - 1 || b[i] != 2) {\n        return null;\n    }\n    ++i;\n    while (b[i] != 0) {\n        if (++i >= b.length) {\n            return null;\n        }\n    }\n    var ret = \"\";\n    while (++i < b.length) {\n        var c = b[i] & 255;\n        if (c < 128) { // utf-8 decode\n            ret += String.fromCharCode(c);\n        }\n        else if ((c > 191) && (c < 224)) {\n            ret += String.fromCharCode(((c & 31) << 6) | (b[i + 1] & 63));\n            ++i;\n        }\n        else {\n            ret += String.fromCharCode(((c & 15) << 12) | ((b[i + 1] & 63) << 6) | (b[i + 2] & 63));\n            i += 2;\n        }\n    }\n    return ret;\n}\n// https://tools.ietf.org/html/rfc3447#page-43\nvar DIGEST_HEADERS = {\n    md2: \"3020300c06082a864886f70d020205000410\",\n    md5: \"3020300c06082a864886f70d020505000410\",\n    sha1: \"3021300906052b0e03021a05000414\",\n    sha224: \"302d300d06096086480165030402040500041c\",\n    sha256: \"3031300d060960864801650304020105000420\",\n    sha384: \"3041300d060960864801650304020205000430\",\n    sha512: \"3051300d060960864801650304020305000440\",\n    ripemd160: \"3021300906052b2403020105000414\"\n};\nfunction getDigestHeader(name) {\n    return DIGEST_HEADERS[name] || \"\";\n}\nfunction removeDigestHeader(str) {\n    for (var name_1 in DIGEST_HEADERS) {\n        if (DIGEST_HEADERS.hasOwnProperty(name_1)) {\n            var header = DIGEST_HEADERS[name_1];\n            var len = header.length;\n            if (str.substr(0, len) == header) {\n                return str.substr(len);\n            }\n        }\n    }\n    return str;\n}\n// Return the PKCS#1 RSA encryption of \"text\" as a Base64-encoded string\n// function RSAEncryptB64(text) {\n//  var h = this.encrypt(text);\n//  if(h) return hex2b64(h); else return null;\n// }\n// public\n// RSAKey.prototype.encrypt_b64 = RSAEncryptB64;\n"],"names":["pkcs1pad1","s","n","uni","len","filler","f","m","parseBigInt","pkcs1pad2","ba","i","c","rng","SecureRandom","x","BigInteger","RSAKey","xp","xq","N","E","text","maxLength","h","length","D","P","Q","DP","DQ","C","B","qs","ee","t","p1","q1","phi","ctext","pkcs1unpad2","callback","rsa","loop1","loop4","loop3","nbi","r","loop2","digestMethod","digestName","header","getDigestHeader","digest","signature","unpadded","removeDigestHeader","d","b","ret","DIGEST_HEADERS","name","str","name_1"],"mappings":"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"}