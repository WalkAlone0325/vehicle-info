{"version":3,"file":"useRaf.js","sources":["uni_modules/wot-design-uni/components/composables/useRaf.ts"],"sourcesContent":["import { ref, onUnmounted } from 'vue'\nimport { isDef, isH5, isNumber } from '../common/util'\n\n// 定义回调函数类型\ntype RafCallback = (time: number) => void\n\nexport function useRaf(callback: RafCallback) {\n  const requestRef = ref<number | null | ReturnType<typeof setTimeout>>(null)\n\n  // 启动动画帧\n  const start = () => {\n    const handle = (time: number) => {\n      callback(time)\n    }\n\n    if (isH5) {\n      requestRef.value = requestAnimationFrame(handle)\n    } else {\n      requestRef.value = setTimeout(() => handle(Date.now()), 1000 / 30)\n    }\n  }\n\n  // 取消动画帧\n  const cancel = () => {\n    if (isH5 && isNumber(requestRef.value)) {\n      cancelAnimationFrame(requestRef.value!)\n    } else if (isDef(requestRef.value)) {\n      clearTimeout(requestRef.value)\n    }\n  }\n\n  onUnmounted(() => {\n    cancel()\n  })\n\n  return { start, cancel }\n}\n"],"names":["useRaf","callback","requestRef","ref","start","handle","time","isH5","cancel","isNumber","isDef","onUnmounted"],"mappings":"4FAMO,SAASA,EAAOC,EAAuB,CACtC,MAAAC,EAAaC,MAAmD,IAAI,EAGpEC,EAAQ,IAAM,CACZ,MAAAC,EAAUC,GAAiB,CAC/BL,EAASK,CAAI,CAAA,EAGXC,OACSL,EAAA,MAAQ,sBAAsBG,CAAM,EAEpCH,EAAA,MAAQ,WAAW,IAAMG,EAAO,KAAK,KAAK,EAAG,IAAO,EAAE,CACnE,EAIIG,EAAS,IAAM,CACfD,QAAQE,EAAAA,SAASP,EAAW,KAAK,EACnC,qBAAqBA,EAAW,KAAM,EAC7BQ,EAAA,MAAMR,EAAW,KAAK,GAC/B,aAAaA,EAAW,KAAK,CAC/B,EAGFS,OAAAA,EAAAA,YAAY,IAAM,CACTH,GAAA,CACR,EAEM,CAAE,MAAAJ,EAAO,OAAAI,EAClB"}