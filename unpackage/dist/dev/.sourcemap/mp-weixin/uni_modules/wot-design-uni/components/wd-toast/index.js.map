{"version":3,"file":"index.js","sources":["uni_modules/wot-design-uni/components/wd-toast/index.ts"],"sourcesContent":["import { inject, provide, ref } from 'vue'\nimport type { Toast, ToastOptions } from './types'\nimport { deepMerge } from '../common/util'\n\n/**\n * useToast 用到的key\n */\nconst toastDefaultOptionKey = '__TOAST_OPTION__'\n\n// 默认模板\nexport const defaultOptions: ToastOptions = {\n  duration: 2000,\n  show: false\n}\n\nconst None = Symbol('None')\n\nexport function useToast(selector: string = ''): Toast {\n  const toastOptionKey = getToastOptionKey(selector)\n  const toastOption = inject(toastOptionKey, ref<ToastOptions | typeof None>(None)) // toast选项\n  if (toastOption.value === None) {\n    toastOption.value = defaultOptions\n    provide(toastOptionKey, toastOption)\n  }\n  let timer: ReturnType<typeof setTimeout> | null = null\n\n  const createMethod = (toastOptions: ToastOptions) => {\n    return (options: ToastOptions | string) => {\n      return show(deepMerge(toastOptions, typeof options === 'string' ? { msg: options } : options) as ToastOptions)\n    }\n  }\n\n  const show = (option: ToastOptions | string) => {\n    const options = deepMerge(defaultOptions, typeof option === 'string' ? { msg: option } : option) as ToastOptions\n    toastOption.value = deepMerge(options, {\n      show: true\n    }) as ToastOptions\n    // 开始渲染，并在 duration ms之后执行清除\n    timer && clearTimeout(timer)\n    if (toastOption.value.duration && toastOption.value.duration > 0) {\n      timer = setTimeout(() => {\n        timer && clearTimeout(timer)\n        close()\n      }, options.duration)\n    }\n  }\n\n  const loading = createMethod({\n    iconName: 'loading',\n    duration: 0,\n    cover: true\n  })\n  const success = createMethod({\n    iconName: 'success',\n    duration: 1500\n  })\n  const error = createMethod({ iconName: 'error' })\n  const warning = createMethod({ iconName: 'warning' })\n  const info = createMethod({ iconName: 'info' })\n\n  const close = () => {\n    toastOption.value = { show: false }\n  }\n  return {\n    show,\n    loading,\n    success,\n    error,\n    warning,\n    info,\n    close\n  }\n}\n\nexport const getToastOptionKey = (selector: string) => {\n  return selector ? `${toastDefaultOptionKey}${selector}` : toastDefaultOptionKey\n}\n\nexport const toastIcon = {\n  success() {\n    return '<svg width=\"42px\" height=\"42px\" viewBox=\"0 0 42 42\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\"><title>成功</title><desc>Created with Sketch.</desc><defs><filter x=\"-63.2%\" y=\"-80.0%\" width=\"226.3%\" height=\"260.0%\" filterUnits=\"objectBoundingBox\" id=\"filter-1\"><feOffset dx=\"0\" dy=\"2\" in=\"SourceAlpha\" result=\"shadowOffsetOuter1\"></feOffset><feGaussianBlur stdDeviation=\"2\" in=\"shadowOffsetOuter1\" result=\"shadowBlurOuter1\"></feGaussianBlur><feColorMatrix values=\"0 0 0 0 0.122733141   0 0 0 0 0.710852582   0 0 0 0 0.514812768  0 0 0 1 0\" type=\"matrix\" in=\"shadowBlurOuter1\" result=\"shadowMatrixOuter1\"></feColorMatrix><feMerge><feMergeNode in=\"shadowMatrixOuter1\"></feMergeNode><feMergeNode in=\"SourceGraphic\"></feMergeNode></feMerge></filter><rect id=\"path-2\" x=\"3.4176226\" y=\"5.81442199\" width=\"3\" height=\"8.5\" rx=\"1.5\"></rect><linearGradient x1=\"50%\" y1=\"0.126649064%\" x2=\"50%\" y2=\"100%\" id=\"linearGradient-4\"><stop stop-color=\"#ACFFBD\" stop-opacity=\"0.208123907\" offset=\"0%\"></stop><stop stop-color=\"#10B87C\" offset=\"100%\"></stop></linearGradient></defs><g id=\"规范\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\"><g id=\"反馈-轻提示\" transform=\"translate(-388.000000, -538.000000)\"><g id=\"成功\" transform=\"translate(388.000000, 538.000000)\"><circle id=\"Oval\" fill=\"#34D19D\" opacity=\"0.400000006\" cx=\"21\" cy=\"21\" r=\"20\"></circle><circle id=\"Oval\" fill=\"#34D19D\" cx=\"21\" cy=\"21\" r=\"16\"></circle><g id=\"Group-6\" filter=\"url(#filter-1)\" transform=\"translate(11.500000, 14.000000)\"><mask id=\"mask-3\" fill=\"white\"><use xlink:href=\"#path-2\"></use></mask><use id=\"Rectangle-Copy-24\" fill=\"#C4FFEB\" transform=\"translate(4.917623, 10.064422) rotate(-45.000000) translate(-4.917623, -10.064422) \" xlink:href=\"#path-2\"></use><rect id=\"Rectangle\" fill=\"url(#linearGradient-4)\" mask=\"url(#mask-3)\" transform=\"translate(6.215869, 11.372277) rotate(-45.000000) translate(-6.215869, -11.372277) \" x=\"4.71586891\" y=\"9.52269089\" width=\"3\" height=\"3.69917136\"></rect><rect id=\"Rectangle\" fill=\"#FFFFFF\" transform=\"translate(11.636236, 7.232744) scale(1, -1) rotate(-45.000000) translate(-11.636236, -7.232744) \" x=\"10.1362361\" y=\"-1.02185365\" width=\"3\" height=\"16.5091951\" rx=\"1.5\"></rect></g></g></g></g></svg>'\n  },\n  warning() {\n    return '<svg width=\"42px\" height=\"42px\" viewBox=\"0 0 42 42\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\"><title>警告</title><desc>Created with Sketch.</desc> <defs> <filter x=\"-240.0%\" y=\"-60.0%\" width=\"580.0%\" height=\"220.0%\" filterUnits=\"objectBoundingBox\" id=\"filter-1\"><feOffset dx=\"0\" dy=\"2\" in=\"SourceAlpha\" result=\"shadowOffsetOuter1\"></feOffset><feGaussianBlur stdDeviation=\"2\" in=\"shadowOffsetOuter1\" result=\"shadowBlurOuter1\"></feGaussianBlur><feColorMatrix values=\"0 0 0 0 0.824756567   0 0 0 0 0.450356612   0 0 0 0 0.168550194  0 0 0 1 0\" type=\"matrix\" in=\"shadowBlurOuter1\" result=\"shadowMatrixOuter1\"></feColorMatrix><feMerge><feMergeNode in=\"shadowMatrixOuter1\"></feMergeNode> <feMergeNode in=\"SourceGraphic\"></feMergeNode></feMerge></filter></defs><g id=\"规范\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\"><g id=\"反馈-轻提示\" transform=\"translate(-580.000000, -538.000000)\"> <g id=\"警告\" transform=\"translate(580.000000, 538.000000)\"><circle id=\"Oval\" fill=\"#F0883A\" opacity=\"0.400000006\" cx=\"21\" cy=\"21\" r=\"20\"></circle><circle id=\"Oval\" fill=\"#F0883A\" cx=\"21\" cy=\"21\" r=\"16\"></circle><g id=\"Group-6\" filter=\"url(#filter-1)\" transform=\"translate(18.500000, 10.800000)\"><rect id=\"Rectangle\" fill=\"#FFFFFF\" transform=\"translate(2.492935, 7.171583) scale(1, -1) rotate(-360.000000) translate(-2.492935, -7.171583) \" x=\"0.992934699\" y=\"0.955464537\" width=\"3\" height=\"12.4322365\" rx=\"1.5\"></rect><rect id=\"Rectangle-Copy-25\" fill=\"#FFDEC5\" transform=\"translate(2.508751, 17.202636) scale(1, -1) rotate(-360.000000) translate(-2.508751, -17.202636) \" x=\"1.00875134\" y=\"15.200563\" width=\"3\" height=\"4.00414639\" rx=\"1.5\"></rect></g></g></g></g></svg>'\n  },\n  info() {\n    return '<svg width=\"42px\" height=\"42px\" viewBox=\"0 0 42 42\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\"><title>常规</title><desc>Created with Sketch.</desc><defs><filter x=\"-300.0%\" y=\"-57.1%\" width=\"700.0%\" height=\"214.3%\" filterUnits=\"objectBoundingBox\" id=\"filter-1\"><feOffset dx=\"0\" dy=\"2\" in=\"SourceAlpha\" result=\"shadowOffsetOuter1\"></feOffset><feGaussianBlur stdDeviation=\"2\" in=\"shadowOffsetOuter1\" result=\"shadowBlurOuter1\"></feGaussianBlur><feColorMatrix values=\"0 0 0 0 0.362700096   0 0 0 0 0.409035039   0 0 0 0 0.520238904  0 0 0 1 0\" type=\"matrix\" in=\"shadowBlurOuter1\" result=\"shadowMatrixOuter1\"></feColorMatrix><feMerge><feMergeNode in=\"shadowMatrixOuter1\"></feMergeNode><feMergeNode in=\"SourceGraphic\"></feMergeNode></feMerge></filter></defs><g id=\"规范\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\"><g id=\"反馈-轻提示\" transform=\"translate(-772.000000, -538.000000)\"><g id=\"常规\" transform=\"translate(772.000000, 538.000000)\"><circle id=\"Oval\" fill=\"#909CB7\" opacity=\"0.4\" cx=\"21\" cy=\"21\" r=\"20\"></circle><circle id=\"Oval\" fill=\"#909CB7\" cx=\"21\" cy=\"21\" r=\"16\"></circle><g id=\"Group-6\" filter=\"url(#filter-1)\" transform=\"translate(18.500000, 9.800000)\"><g id=\"编组-2\" transform=\"translate(2.492935, 10.204709) rotate(-180.000000) translate(-2.492935, -10.204709) translate(0.992935, 0.204709)\"><rect id=\"Rectangle\" fill=\"#FFFFFF\" transform=\"translate(1.500000, 7.000000) scale(1, -1) rotate(-360.000000) translate(-1.500000, -7.000000) \" x=\"0\" y=\"0\" width=\"3\" height=\"14\" rx=\"1.5\"></rect><rect id=\"Rectangle-Copy-25\" fill=\"#EEEEEE\" transform=\"translate(1.500000, 18.000000) scale(1, -1) rotate(-360.000000) translate(-1.500000, -18.000000) \" x=\"0\" y=\"16\" width=\"3\" height=\"4\" rx=\"1.5\"></rect></g></g></g></g></g></svg>'\n  },\n  error() {\n    return '<svg width=\"42px\" height=\"42px\" viewBox=\"0 0 42 42\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\"><title>toast</title><desc>Created with Sketch.</desc><defs><linearGradient x1=\"99.6229896%\" y1=\"50.3770104%\" x2=\"0.377010363%\" y2=\"50.3770104%\" id=\"linearGradient-1\"><stop stop-color=\"#FFDFDF\" offset=\"0%\"></stop><stop stop-color=\"#F9BEBE\" offset=\"100%\"></stop></linearGradient><linearGradient x1=\"0.377010363%\" y1=\"50.3770104%\" x2=\"99.6229896%\" y2=\"50.3770104%\" id=\"linearGradient-2\"><stop stop-color=\"#FFDFDF\" offset=\"0%\"></stop><stop stop-color=\"#F9BEBE\" offset=\"100%\"></stop></linearGradient></defs><g id=\"规范\" stroke=\"none\" stroke-width=\"1\" fill=\"none\" fill-rule=\"evenodd\"><g id=\"反馈-轻提示\" transform=\"translate(-196.000000, -538.000000)\"> <g id=\"toast\" transform=\"translate(196.000000, 538.000000)\"><circle id=\"Oval\" fill=\"#FA4350\" opacity=\"0.400000006\" cx=\"21\" cy=\"21\" r=\"20\"></circle><circle id=\"Oval\" fill=\"#FA4350\" opacity=\"0.900000036\" cx=\"21\" cy=\"21\" r=\"16\"></circle><rect id=\"矩形\" fill=\"#FFDFDF\" transform=\"translate(21.071068, 21.071068) rotate(-225.000000) translate(-21.071068, -21.071068) \" x=\"12.5710678\" y=\"19.5710678\" width=\"17\" height=\"3\" rx=\"1.5\"></rect><rect id=\"矩形\" fill=\"url(#linearGradient-1)\" transform=\"translate(19.303301, 22.838835) rotate(-225.000000) translate(-19.303301, -22.838835) \" x=\"17.3033009\" y=\"21.3388348\" width=\"4\" height=\"3\"></rect><rect id=\"矩形\" fill=\"url(#linearGradient-2)\" transform=\"translate(22.838835, 19.303301) rotate(-225.000000) translate(-22.838835, -19.303301) \" x=\"20.8388348\" y=\"17.8033009\" width=\"4\" height=\"3\"></rect><rect id=\"矩形\" fill=\"#FFFFFF\" transform=\"translate(21.071068, 21.071068) rotate(-315.000000) translate(-21.071068, -21.071068) \" x=\"12.5710678\" y=\"19.5710678\" width=\"17\" height=\"3\" rx=\"1.5\"></rect></g></g></g></svg>'\n  }\n}\n"],"names":["toastDefaultOptionKey","defaultOptions","None","useToast","selector","toastOptionKey","getToastOptionKey","toastOption","inject","ref","provide","timer","createMethod","toastOptions","options","show","deepMerge","option","close","loading","success","error","warning","info","toastIcon"],"mappings":"4FAOMA,EAAwB,mBAGjBC,EAA+B,CAC1C,SAAU,IACV,KAAM,EACR,EAEMC,EAAO,OAAO,MAAM,EAEV,SAAAC,EAASC,EAAmB,GAAW,CAC/C,MAAAC,EAAiBC,EAAkBF,CAAQ,EAC3CG,EAAcC,EAAAA,OAAOH,EAAgBI,EAAAA,IAAgCP,CAAI,CAAC,EAC5EK,EAAY,QAAUL,IACxBK,EAAY,MAAQN,EACpBS,UAAQL,EAAgBE,CAAW,GAErC,IAAII,EAA8C,KAE5C,MAAAC,EAAgBC,GACZC,GACCC,EAAKC,EAAAA,UAAUH,EAAc,OAAOC,GAAY,SAAW,CAAE,IAAKA,GAAYA,CAAO,CAAiB,EAI3GC,EAAQE,GAAkC,CACxC,MAAAH,EAAUE,EAAAA,UAAUf,EAAgB,OAAOgB,GAAW,SAAW,CAAE,IAAKA,GAAWA,CAAM,EACnFV,EAAA,MAAQS,YAAUF,EAAS,CACrC,KAAM,EAAA,CACP,EAEDH,GAAS,aAAaA,CAAK,EACvBJ,EAAY,MAAM,UAAYA,EAAY,MAAM,SAAW,IAC7DI,EAAQ,WAAW,IAAM,CACvBA,GAAS,aAAaA,CAAK,EACrBO,GAAA,EACLJ,EAAQ,QAAQ,EACrB,EAGIK,EAAUP,EAAa,CAC3B,SAAU,UACV,SAAU,EACV,MAAO,EAAA,CACR,EACKQ,EAAUR,EAAa,CAC3B,SAAU,UACV,SAAU,IAAA,CACX,EACKS,EAAQT,EAAa,CAAE,SAAU,OAAS,CAAA,EAC1CU,EAAUV,EAAa,CAAE,SAAU,SAAW,CAAA,EAC9CW,EAAOX,EAAa,CAAE,SAAU,MAAQ,CAAA,EAExCM,EAAQ,IAAM,CACNX,EAAA,MAAQ,CAAE,KAAM,EAAM,CAAA,EAE7B,MAAA,CACL,KAAAQ,EACA,QAAAI,EACA,QAAAC,EACA,MAAAC,EACA,QAAAC,EACA,KAAAC,EACA,MAAAL,CAAA,CAEJ,CAEa,MAAAZ,EAAqBF,GACzBA,EAAW,GAAGJ,CAAqB,GAAGI,CAAQ,GAAKJ,EAG/CwB,EAAY,CACvB,SAAU,CACD,MAAA,4sEACT,EACA,SAAU,CACD,MAAA,4qDACT,EACA,MAAO,CACE,MAAA,yvDACT,EACA,OAAQ,CACC,MAAA,wyDACT,CACF"}