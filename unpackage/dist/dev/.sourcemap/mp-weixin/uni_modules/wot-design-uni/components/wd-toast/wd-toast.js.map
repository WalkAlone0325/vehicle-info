{"version":3,"file":"wd-toast.js","sources":["uni_modules/wot-design-uni/components/wd-toast/wd-toast.vue","/Users/jing/Code/mini/vehicle-info/uni_modules/wot-design-uni/components/wd-toast/wd-toast.vue?type=component"],"sourcesContent":["<template>\n  <wd-overlay v-if=\"cover\" :z-index=\"zIndex\" lock-scroll :show=\"show\" custom-style=\"background-color: transparent;pointer-events: auto;\"></wd-overlay>\n  <wd-transition name=\"fade\" :show=\"show\" :custom-style=\"transitionStyle\" @after-enter=\"handleAfterEnter\" @after-leave=\"handleAfterLeave\">\n    <view :class=\"rootClass\">\n      <!--iconName优先级更高-->\n      <wd-loading\n        v-if=\"iconName === 'loading'\"\n        :type=\"loadingType\"\n        :color=\"loadingColor\"\n        :size=\"loadingSize\"\n        :custom-class=\"`wd-toast__icon ${direction === 'vertical' ? 'is-vertical' : ''}`\"\n      />\n      <view\n        :class=\"`wd-toast__iconWrap wd-toast__icon ${direction === 'vertical' ? 'is-vertical' : ''}`\"\n        v-else-if=\"iconName === 'success' || iconName === 'warning' || iconName === 'info' || iconName === 'error'\"\n      >\n        <view class=\"wd-toast__iconBox\">\n          <view class=\"wd-toast__iconSvg\" :style=\"svgStyle\"></view>\n        </view>\n      </view>\n      <wd-icon\n        v-else-if=\"iconClass\"\n        :custom-class=\"`wd-toast__icon ${direction === 'vertical' ? 'is-vertical' : ''}`\"\n        :size=\"iconSize\"\n        :class-prefix=\"classPrefix\"\n        :name=\"iconClass\"\n      ></wd-icon>\n      <!--文本-->\n      <view v-if=\"msg\" class=\"wd-toast__msg\">{{ msg }}</view>\n    </view>\n  </wd-transition>\n</template>\n\n<script lang=\"ts\">\nexport default {\n  name: 'wd-toast',\n  options: {\n    addGlobalClass: true,\n    virtualHost: true,\n    styleIsolation: 'shared'\n  }\n}\n</script>\n\n<script lang=\"ts\" setup>\nimport wdIcon from '../wd-icon/wd-icon.vue'\nimport wdLoading from '../wd-loading/wd-loading.vue'\nimport wdOverlay from '../wd-overlay/wd-overlay.vue'\nimport wdTransition from '../wd-transition/wd-transition.vue'\n\nimport { computed, inject, onBeforeMount, ref, watch, type CSSProperties } from 'vue'\nimport base64 from '../common/base64'\nimport { defaultOptions, getToastOptionKey, toastIcon } from '.'\nimport { toastProps, type ToastDirection, type ToastLoadingType, type ToastOptions, type ToastProps } from './types'\nimport { addUnit, isDef, isFunction, objToStyle } from '../common/util'\n\nconst props = defineProps(toastProps)\nconst iconName = ref<string>('') // 图标类型\nconst msg = ref<string>('') // 消息内容\nconst position = ref<string>('middle')\nconst show = ref<boolean>(false)\nconst zIndex = ref<number>(100)\nconst loadingType = ref<ToastLoadingType>('outline')\nconst loadingColor = ref<string>('#4D80F0')\nconst iconSize = ref<string>() // 图标大小\nconst loadingSize = ref<string>() // loading大小\nconst svgStr = ref<string>('') // 图标\nconst cover = ref<boolean>(false) // 是否存在遮罩层\nconst classPrefix = ref<string>('wd-icon') // 图标前缀\nconst iconClass = ref<string>('') // 图标类名\nconst direction = ref<ToastDirection>('horizontal') // toast布局方向\n\nlet opened: (() => void) | null = null\n\nlet closed: (() => void) | null = null\n\nconst toastOptionKey = getToastOptionKey(props.selector)\nconst toastOption = inject(toastOptionKey, ref<ToastOptions>(defaultOptions)) // toast选项\n\n// 监听options变化展示\nwatch(\n  () => toastOption.value,\n  (newVal: ToastOptions) => {\n    reset(newVal)\n  },\n  {\n    deep: true,\n    immediate: true\n  }\n)\n\n// 监听options变化展示\nwatch(\n  () => iconName.value,\n  () => {\n    buildSvg()\n  },\n  {\n    deep: true,\n    immediate: true\n  }\n)\n\n/**\n * 动画自定义样式\n */\nconst transitionStyle = computed(() => {\n  const style: CSSProperties = {\n    'z-index': zIndex.value,\n    position: 'fixed',\n    top: '50%',\n    left: 0,\n    width: '100%',\n    transform: 'translate(0, -50%)',\n    'text-align': 'center',\n    'pointer-events': 'none'\n  }\n  return objToStyle(style)\n})\n\nconst rootClass = computed(() => {\n  return `wd-toast ${props.customClass} wd-toast--${position.value} ${\n    (iconName.value !== 'loading' || msg.value) && (iconName.value || iconClass.value) ? 'wd-toast--with-icon' : ''\n  } ${iconName.value === 'loading' && !msg.value ? 'wd-toast--loading' : ''} ${direction.value === 'vertical' ? 'is-vertical' : ''}`\n})\n\nconst svgStyle = computed(() => {\n  const style: CSSProperties = {\n    backgroundImage: `url(${svgStr.value})`\n  }\n  if (isDef(iconSize.value)) {\n    style.width = iconSize.value\n    style.height = iconSize.value\n  }\n  return objToStyle(style)\n})\n\nonBeforeMount(() => {\n  buildSvg()\n})\n\nfunction handleAfterEnter() {\n  if (isFunction(opened)) {\n    opened()\n  }\n}\n\nfunction handleAfterLeave() {\n  if (isFunction(closed)) {\n    closed()\n  }\n}\n\nfunction buildSvg() {\n  if (iconName.value !== 'success' && iconName.value !== 'warning' && iconName.value !== 'info' && iconName.value !== 'error') return\n  const iconSvg = toastIcon[iconName.value]()\n  const iconSvgStr = `\"data:image/svg+xml;base64,${base64(iconSvg)}\"`\n  svgStr.value = iconSvgStr\n}\n\n/**\n * 重置toast选项值\n * @param option toast选项值\n */\nfunction reset(option: ToastOptions) {\n  show.value = isDef(option.show) ? option.show : false\n\n  if (show.value) {\n    mergeOptionsWithProps(option, props)\n  }\n}\n\nfunction mergeOptionsWithProps(option: ToastOptions, props: ToastProps) {\n  iconName.value = isDef(option.iconName!) ? option.iconName! : props.iconName\n  iconClass.value = isDef(option.iconClass!) ? option.iconClass! : props.iconClass\n  msg.value = isDef(option.msg!) ? option.msg! : props.msg\n  position.value = isDef(option.position!) ? option.position! : props.position\n  zIndex.value = isDef(option.zIndex!) ? option.zIndex! : props.zIndex\n  loadingType.value = isDef(option.loadingType!) ? option.loadingType! : props.loadingType\n  loadingColor.value = isDef(option.loadingColor!) ? option.loadingColor! : props.loadingColor\n  iconSize.value = isDef(option.iconSize) ? addUnit(option.iconSize) : isDef(props.iconSize) ? addUnit(props.iconSize) : undefined\n  loadingSize.value = isDef(option.loadingSize) ? addUnit(option.loadingSize) : isDef(props.loadingSize) ? addUnit(props.loadingSize) : undefined\n  cover.value = isDef(option.cover!) ? option.cover! : props.cover\n  classPrefix.value = isDef(option.classPrefix) ? option.classPrefix : props.classPrefix\n  direction.value = isDef(option.direction) ? option.direction : props.direction\n  closed = isFunction(option.closed) ? option.closed : isFunction(props.closed) ? props.closed : null\n  opened = isFunction(option.opened) ? option.opened : isFunction(props.opened) ? props.opened : null\n}\n</script>\n<style lang=\"scss\" scoped>\n@import './index.scss';\n</style>\n","import Component from '/Users/jing/Code/mini/vehicle-info/uni_modules/wot-design-uni/components/wd-toast/wd-toast.vue'\nwx.createComponent(Component)"],"names":["wdIcon","wdLoading","wdOverlay","wdTransition","__default__","props","__props","iconName","ref","msg","position","show","zIndex","loadingType","loadingColor","iconSize","loadingSize","svgStr","cover","classPrefix","iconClass","direction","opened","closed","toastOptionKey","getToastOptionKey","toastOption","inject","defaultOptions","watch","newVal","reset","buildSvg","transitionStyle","computed","style","objToStyle","rootClass","svgStyle","isDef","onBeforeMount","handleAfterEnter","isFunction","handleAfterLeave","iconSvg","toastIcon","iconSvgStr","base64","option","mergeOptionsWithProps","addUnit","Component"],"mappings":"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"}