{"version":3,"file":"useParent.js","sources":["uni_modules/wot-design-uni/components/composables/useParent.ts"],"sourcesContent":["import {\n  ref,\n  inject,\n  computed,\n  onUnmounted,\n  type InjectionKey,\n  getCurrentInstance,\n  type ComponentPublicInstance,\n  type ComponentInternalInstance\n} from 'vue'\n\ntype ParentProvide<T> = T & {\n  link(child: ComponentInternalInstance): void\n  unlink(child: ComponentInternalInstance): void\n  children: ComponentPublicInstance[]\n  internalChildren: ComponentInternalInstance[]\n}\n\nexport function useParent<T>(key: InjectionKey<ParentProvide<T>>) {\n  const parent = inject(key, null)\n\n  if (parent) {\n    const instance = getCurrentInstance()!\n    const { link, unlink, internalChildren } = parent\n\n    link(instance)\n    onUnmounted(() => unlink(instance))\n\n    const index = computed(() => internalChildren.indexOf(instance))\n\n    return {\n      parent,\n      index\n    }\n  }\n\n  return {\n    parent: null,\n    index: ref(-1)\n  }\n}\n"],"names":["useParent","key","parent","inject","instance","getCurrentInstance","link","unlink","internalChildren","onUnmounted","index","computed","ref"],"mappings":"6DAkBO,SAASA,EAAaC,EAAqC,CAC1D,MAAAC,EAASC,EAAAA,OAAOF,EAAK,IAAI,EAE/B,GAAIC,EAAQ,CACV,MAAME,EAAWC,EAAAA,qBACX,CAAE,KAAAC,EAAM,OAAAC,EAAQ,iBAAAC,CAAA,EAAqBN,EAE3CI,EAAKF,CAAQ,EACDK,EAAAA,YAAA,IAAMF,EAAOH,CAAQ,CAAC,EAElC,MAAMM,EAAQC,EAAAA,SAAS,IAAMH,EAAiB,QAAQJ,CAAQ,CAAC,EAExD,MAAA,CACL,OAAAF,EACA,MAAAQ,CAAA,CAEJ,CAEO,MAAA,CACL,OAAQ,KACR,MAAOE,EAAAA,IAAI,EAAE,CAAA,CAEjB"}